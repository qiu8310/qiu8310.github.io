{"version":3,"sources":["webpack:///main.c6da7a8b.js","webpack:///./client/main.tsx","webpack:///./client/components/message/parts.tsx","webpack:///./client/components/message/types.tsx","webpack:///./client/components/message/Message/MessageRender.tsx","webpack:///./client/components/message/Message/MessageFactory.tsx","webpack:///./mock/types.ts","webpack:///./client/components/message/Message/index.tsx","webpack:///./client/components/message/MessageGroup/MessageGroup.tsx","webpack:///./client/libs/base.tsx","webpack:///./client/components/message/Message/renders/styles/community.scss","webpack:///./client/components/message/Message/renders/styles/subscribe.scss","webpack:///./client/components/message/MessageGroup/styles.scss","webpack:///./client/components/message/Message/renders \\.tsx$","webpack:///./client/components/message/App/App.tsx","webpack:///./client/components/message/Header/Header.tsx","webpack:///./client/components/message/Loading/Loading.tsx","webpack:///./client/components/message/Message/MessageBuilder.tsx","webpack:///./client/components/message/Message/renders/CourseMessageRender.tsx","webpack:///./client/components/message/Message/renders/FansMessageRender.tsx","webpack:///./client/components/message/Message/renders/MagazineMessageRender.tsx","webpack:///./client/components/message/Message/renders/ReplyMessageRender.tsx","webpack:///./client/components/message/Message/renders/SystemMessageRender.tsx","webpack:///./client/components/message/MessageGroup/MixedMessageGroup.tsx","webpack:///./client/components/message/MessageGroup/SimpleMessageGroup.tsx","webpack:///./client/components/message/MessageGroup/index.tsx","webpack:///./client/components/message/Nav/Nav.tsx","webpack:///./client/libs/api.tsx","webpack:///./client/libs/helper.tsx","webpack:///./client/libs/store.tsx","webpack:///./client/share/routes.tsx","webpack:///./mock/generator.ts","webpack:///./mock/index.ts","webpack:///./client/components/message/Header/header.scss","webpack:///./client/components/message/Loading/loading.scss","webpack:///./client/components/message/Message/renders/styles/common.scss","webpack:///./client/components/message/Message/renders/styles/notice.scss","webpack:///./client/components/message/Nav/nav.scss"],"names":["webpackJsonp","module","exports","__webpack_require__","base_1","react_router_1","routes_1","history","browserHistory","render","React","createElement","Router","routes","document","querySelector","__export","m","p","hasOwnProperty","register","ctor","MessageFactory_1","MessageFactory","registerComponent","type","__extends","d","b","__","this","constructor","prototype","Object","create","types_1","parts_1","style","MessageRender","_super","apply","arguments","renderCommunityUser","user","humanTime","className","avatar","avatarImg","src","detail","username","name","pubtime","renderExternal","_a","props","message","business","category","unread","key","Business","label","BusinessMap","from","to","Link","external","Component","map","component","getComponent","enumKeys","e","keys","filter","k","_reNumber","test","enumValues","parseInt","Category","CategoryMap","notice","community","subscribe","CategoryKeys","defaultCategoryKey","cctalk","hujiang","league","hjclass","BusinessKeys","defaultBusinessKey","Type","ctx","forEach","ctorName","RegExp","$1","MessageGroup","call","params","state","getInitState","createInitState","messages","page","pageSize","hideLoading","getConstructor","initState","componentDidMount","_isMounted","componentWillUnmount","_typeof","Symbol","iterator","obj","react_dom_1","findDOMNode","isClient","window","isServer","classSet","_this","args","_i","length","result","arg","Array","isArray","push","join","item","follows","follow","content","grayBackground","title","time","cover","body","link","list","mixedList","simpleList","download","webpackContext","req","webpackContextResolve","Error","./CourseMessageRender.tsx","./FansMessageRender.tsx","./MagazineMessageRender.tsx","./ReplyMessageRender.tsx","./SystemMessageRender.tsx","resolve","id","App","getChildContext","children","childContextTypes","PropTypes","string","Header","back","goBack","header","onClick","bind","Loading","_isMounded","load","el","refs","isHandleing","handler","done","screenHeight","innerHeight","finished","setState","unhandle","getBoundingClientRect","top","bottom","handle","reload","_handler","addEventListener","removeEventListener","hide","ref","loading","spin","MessageBuilder","console","error","MessageRender_1","CourseMessageRender","data-flex","href","data-clamp","createTime","Course","FansMessageRender","fans","len","firstFan","fan","index","Fans","MagazineMessageRender","series","Magazine","ReplyMessageRender","answer","Reply","SystemMessageRender","clamp","handleClick","System","_1","MessageGroup_1","parts_2","MixedMessageGroup","isomorphic","_clientState","api","getCagegoryMessages","then","data","collection","total","setServerTime","now","size","dots","store","get","set","Promise","getMessageList","_b","componentWillReceiveProps","context","Nav","contextTypes","SimpleMessageGroup","subBusiness","getBusinessUnreadMessages","showAppBanner","_c","app","path","dot","activeClassName","active","nav","elegantApi","base","response","order","request","cache","enable","expireSeconds","dataTransformMethod","mock","memory","server","target","cb","routeName","log","http","url","rtnData","errorMessage","oldError","status","method","crossOrigin","dataType","JSON","stringify","fetch","res","json","err","catch","query","getMessage","mocks","win","G","eaCache","$cache","diffMillseconds","Date","getServerTime","warn","lastTime","lastDate","currentDate","diff","currentTime","Math","floor","year","getFullYear","month","getMonth","day","getDate","unshift","_storeData","defaultVal","val","append","items","getBusiness","getCategory","c","createRedirectIndexRoute","onEnter","next","replace","location","pathname","search","indexRoute","childRoutes","rand","min","max","random","sample","sampleEnumValue","sampleEnumKey","text","fill","enumText","Generator","User","Message","num","generate","i","enumFamilyName","split","enumGiveName","enumAvatar","trim","bool","image","oneDay","lastCreateTime","getCreateTime","round","lastId","giveName","isRead","readTime","SystemMessage","ReplyMessage","FansMessage","CourseMessage","MagazineMessage","save","getUnreadCountBy","getUnreadCountByCategory","businessCollection","getUnreadCountByBusiness","categoryCollection","CATEGORY_MESSAGES","BUSINESS_MESSAGES","mb","slice","checkCategory","callback","checkBusinese","check","generator_1","TOTAL_MESSAGE","TOTAL_READ_MESSAGE","MESSAGES","reverse","found","$default"],"mappings":"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","file":"main.c6da7a8b.js","sourcesContent":["webpackJsonp([2],[\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\t__webpack_require__(71); // 最先加载样式\n\tvar base_1 = __webpack_require__(28);\n\tvar react_router_1 = __webpack_require__(14);\n\tvar routes_1 = __webpack_require__(64);\n\tvar history =  false ? react_router_1.hashHistory : react_router_1.browserHistory;\n\tbase_1.render(base_1.React.createElement(react_router_1.Router, { routes: routes_1.routes, history: history }), document.querySelector('main'));\n\n/***/ },\n/* 1 */,\n/* 2 */,\n/* 3 */,\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tfunction __export(m) {\n\t    for (var p in m) {\n\t        if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n\t    }\n\t}\n\t__export(__webpack_require__(28));\n\t__export(__webpack_require__(48));\n\t__export(__webpack_require__(49));\n\t__export(__webpack_require__(60));\n\t__export(__webpack_require__(50));\n\t__export(__webpack_require__(62));\n\t__export(__webpack_require__(63));\n\t__export(__webpack_require__(61));\n\n/***/ },\n/* 5 */,\n/* 6 */,\n/* 7 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tfunction __export(m) {\n\t    for (var p in m) {\n\t        if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n\t    }\n\t}\n\t__export(__webpack_require__(16));\n\n/***/ },\n/* 8 */,\n/* 9 */,\n/* 10 */,\n/* 11 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar __extends = undefined && undefined.__extends || function (d, b) {\n\t    for (var p in b) {\n\t        if (b.hasOwnProperty(p)) d[p] = b[p];\n\t    }function __() {\n\t        this.constructor = d;\n\t    }\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t};\n\tvar types_1 = __webpack_require__(7);\n\tvar parts_1 = __webpack_require__(4);\n\tvar react_router_1 = __webpack_require__(14);\n\tvar MessageFactory_1 = __webpack_require__(15);\n\tvar style = __webpack_require__(74);\n\tvar MessageRender = function (_super) {\n\t    __extends(MessageRender, _super);\n\t    function MessageRender() {\n\t        _super.apply(this, arguments);\n\t    }\n\t    MessageRender.prototype.renderCommunityUser = function (user, humanTime, style) {\n\t        return parts_1.React.createElement(\"div\", { className: style.user }, parts_1.React.createElement(\"div\", { className: style.avatar }, parts_1.React.createElement(\"img\", { className: style.avatarImg, src: user.avatar })), parts_1.React.createElement(\"div\", { className: style.detail }, parts_1.React.createElement(\"h3\", { className: style.username }, user.name), parts_1.React.createElement(\"span\", { className: style.pubtime }, humanTime)));\n\t    };\n\t    MessageRender.prototype.renderExternal = function () {\n\t        var _a = this.props,\n\t            m = _a.message,\n\t            business = _a.business,\n\t            category = _a.category,\n\t            unread = _a.unread;\n\t        var key = types_1.Business[m.business],\n\t            label = types_1.BusinessMap[key];\n\t        if (key === business || !unread || !unread[key]) return null;\n\t        if (unread[key] === 1) {\n\t            return parts_1.React.createElement(\"p\", { className: style.from }, \"来自\", label);\n\t        } else {\n\t            var to = \"/\" + business + \"/\" + category + \"/\" + key;\n\t            return parts_1.React.createElement(react_router_1.Link, { className: style.external, to: to }, label, \"还有\", unread[key], \"条未读消息 >\");\n\t        }\n\t    };\n\t    return MessageRender;\n\t}(parts_1.Component);\n\texports.MessageRender = MessageRender;\n\tfunction register(ctor) {\n\t    MessageFactory_1.MessageFactory.registerComponent(ctor.type, ctor);\n\t}\n\texports.register = register;\n\n/***/ },\n/* 12 */,\n/* 13 */,\n/* 14 */,\n/* 15 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tvar map = {};\n\tvar MessageFactory = function () {\n\t    function MessageFactory() {}\n\t    MessageFactory.registerComponent = function (type, component) {\n\t        map[type] = component;\n\t    };\n\t    MessageFactory.getComponent = function (type) {\n\t        return map[type];\n\t    };\n\t    return MessageFactory;\n\t}();\n\texports.MessageFactory = MessageFactory;\n\n/***/ },\n/* 16 */\n/***/ function(module, exports) {\n\n\t/*\r\n\t  * category 分类\r\n\t    - notice  通知类的消息\r\n\t    - subscribe 订阅类的消息\r\n\t    - community 社交类的消息\r\n\t\r\n\t  * business 业务线\r\n\t    - cctalk  CCTALK的消息\r\n\t    - hujiang 沪江学习的消息\r\n\t    - league  沪江辞场的消息\r\n\t    - hjclass 沪江网校的消息\r\n\t\r\n\t  * type 消息类型，类型决定了此消息包含的字段\r\n\t    - System 系统消息\r\n\t    - ...(这是会动态变化的，所以就不一一列出了，参见 enum Type)\r\n\t*/\n\t\"use strict\";\n\t\n\tvar _reNumber = /^\\d+$/;\n\t/**\r\n\t * 消息的分类\r\n\t */\n\t(function (Category) {\n\t    Category[Category[\"notice\"] = 1] = \"notice\";\n\t    Category[Category[\"community\"] = 2] = \"community\";\n\t    Category[Category[\"subscribe\"] = 3] = \"subscribe\";\n\t})(exports.Category || (exports.Category = {}));\n\tvar Category = exports.Category;\n\texports.CategoryMap = {\n\t    notice: '通知',\n\t    community: '社交',\n\t    subscribe: '订阅'\n\t};\n\t// 控制了 Nav 导航的顺序\n\texports.CategoryKeys = ['notice', 'community', 'subscribe'];\n\texports.defaultCategoryKey = exports.CategoryKeys[0];\n\t/**\r\n\t * 消息所属业务线\r\n\t */\n\t(function (Business) {\n\t    Business[Business[\"cctalk\"] = 1] = \"cctalk\";\n\t    Business[Business[\"hujiang\"] = 2] = \"hujiang\";\n\t    Business[Business[\"league\"] = 3] = \"league\";\n\t    Business[Business[\"hjclass\"] = 4] = \"hjclass\";\n\t})(exports.Business || (exports.Business = {}));\n\tvar Business = exports.Business;\n\texports.BusinessMap = {\n\t    cctalk: 'CCTalk',\n\t    hujiang: '沪江学习',\n\t    league: '沪江词场',\n\t    hjclass: '沪江网校'\n\t};\n\texports.BusinessKeys = enumKeys(Business);\n\texports.defaultBusinessKey = exports.BusinessKeys[0];\n\t/**\r\n\t * 消息各类\r\n\t *\r\n\t * 可以理解成 Category 的细分，不同的 Type 决定的消息的结构\r\n\t */\n\t(function (Type) {\n\t    // Notice\n\t    Type[Type[\"System\"] = 1] = \"System\";\n\t    // Community\n\t    Type[Type[\"Reply\"] = 2] = \"Reply\";\n\t    Type[Type[\"Fans\"] = 3] = \"Fans\";\n\t    // Subscribe\n\t    Type[Type[\"Course\"] = 4] = \"Course\";\n\t    Type[Type[\"Magazine\"] = 5] = \"Magazine\"; // 社团的期刊更新消息\n\t})(exports.Type || (exports.Type = {}));\n\tvar Type = exports.Type;\n\t// 实用函数\n\tfunction enumKeys(e) {\n\t    return Object.keys(e).filter(function (k) {\n\t        return !_reNumber.test(k);\n\t    });\n\t}\n\texports.enumKeys = enumKeys;\n\tfunction enumValues(e) {\n\t    return Object.keys(e).filter(function (k) {\n\t        return _reNumber.test(k);\n\t    }).map(function (k) {\n\t        return parseInt(k, 10);\n\t    });\n\t}\n\texports.enumValues = enumValues;\n\n/***/ },\n/* 17 */,\n/* 18 */,\n/* 19 */,\n/* 20 */,\n/* 21 */,\n/* 22 */,\n/* 23 */,\n/* 24 */,\n/* 25 */,\n/* 26 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tfunction __export(m) {\n\t    for (var p in m) {\n\t        if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n\t    }\n\t}\n\tvar MessageFactory_1 = __webpack_require__(15);\n\tvar ctx = __webpack_require__(46);\n\tctx.keys().forEach(function (key) {\n\t    if (/(\\w+)\\.tsx/.test(key)) {\n\t        var ctorName = RegExp.$1;\n\t        var ctor = ctx(key)[ctorName];\n\t        MessageFactory_1.MessageFactory.registerComponent(ctor.type, ctor);\n\t    }\n\t});\n\t__export(__webpack_require__(15));\n\t__export(__webpack_require__(51));\n\t__export(__webpack_require__(11));\n\n/***/ },\n/* 27 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar __extends = undefined && undefined.__extends || function (d, b) {\n\t    for (var p in b) {\n\t        if (b.hasOwnProperty(p)) d[p] = b[p];\n\t    }function __() {\n\t        this.constructor = d;\n\t    }\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t};\n\tvar parts_1 = __webpack_require__(4);\n\tvar MessageGroup = function (_super) {\n\t    __extends(MessageGroup, _super);\n\t    function MessageGroup(props) {\n\t        _super.call(this, props);\n\t        var params = props.params;\n\t        this.state = this.getInitState();\n\t    }\n\t    MessageGroup.createInitState = function () {\n\t        return {\n\t            messages: [],\n\t            page: 0,\n\t            pageSize: 10,\n\t            hideLoading: false\n\t        };\n\t    };\n\t    MessageGroup.prototype.getInitState = function () {\n\t        return this.getConstructor().initState || MessageGroup.createInitState();\n\t    };\n\t    MessageGroup.prototype.componentDidMount = function () {\n\t        this._isMounted = true;\n\t    };\n\t    MessageGroup.prototype.componentWillUnmount = function () {\n\t        _super.prototype.componentWillUnmount.call(this);\n\t        this._isMounted = false;\n\t    };\n\t    return MessageGroup;\n\t}(parts_1.Component);\n\texports.MessageGroup = MessageGroup;\n\n/***/ },\n/* 28 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\t\n\tvar __extends = undefined && undefined.__extends || function (d, b) {\n\t    for (var p in b) {\n\t        if (b.hasOwnProperty(p)) d[p] = b[p];\n\t    }function __() {\n\t        this.constructor = d;\n\t    }\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t};\n\tvar React = __webpack_require__(2);\n\texports.React = React;\n\tvar react_dom_1 = __webpack_require__(38);\n\texports.render = react_dom_1.render;\n\texports.findDOMNode = react_dom_1.findDOMNode;\n\tvar isClient = typeof window !== 'undefined';\n\tvar Component = function (_super) {\n\t    __extends(Component, _super);\n\t    function Component(props) {\n\t        _super.call(this, props);\n\t        this.isClient = isClient;\n\t        this.isServer = !isClient;\n\t        var initState = {};\n\t        this.state = initState;\n\t    }\n\t    Component.prototype.getConstructor = function () {\n\t        return this.constructor;\n\t    };\n\t    Component.prototype.componentWillUnmount = function () {\n\t        this.state = null;\n\t    };\n\t    Component.prototype.classSet = function () {\n\t        var _this = this;\n\t        var args = [];\n\t        for (var _i = 0; _i < arguments.length; _i++) {\n\t            args[_i - 0] = arguments[_i];\n\t        }\n\t        var result = [];\n\t        args.forEach(function (arg) {\n\t            if (arg) {\n\t                if (Array.isArray(arg)) result.push(_this.classSet.apply(_this, arg));else if (typeof arg === 'string') result.push(arg);else if ((typeof arg === 'undefined' ? 'undefined' : _typeof(arg)) === 'object') result.push.apply(result, Object.keys(arg).filter(function (k) {\n\t                    return arg[k];\n\t                }));\n\t            }\n\t        });\n\t        return result.join(' ');\n\t    };\n\t    return Component;\n\t}(React.Component);\n\texports.Component = Component;\n\n/***/ },\n/* 29 */,\n/* 30 */\n/***/ function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\tmodule.exports = {\"item\":\"_2B-f9hZJ\",\"follows\":\"_2RZvCCkc\",\"follow\":\"_1NdWkpm_\",\"content\":\"WvLqlPY4\",\"grayBackground\":\"Wdx77iE2\",\"title\":\"_2HeKYZEe\",\"time\":\"_2qoCqGt2\",\"user\":\"_1awaliRa\",\"avatar\":\"_1TuoDfl3\",\"avatarImg\":\"_2uGIXoAc\",\"detail\":\"BVDdfqVb\",\"username\":\"_3VrkeQKK\",\"pubtime\":\"_3niHB7o3\"};\n\n/***/ },\n/* 31 */\n/***/ function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\tmodule.exports = {\"item\":\"_3i0McZiX\",\"cover\":\"_2UMXibsD\",\"body\":\"_3QZU8LU4\",\"link\":\"_32Wjc51I\",\"title\":\"_1frtJDd9\",\"time\":\"_3By44e0d\",\"content\":\"rBo7kFC4\"};\n\n/***/ },\n/* 32 */\n/***/ function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\tmodule.exports = {\"list\":\"P3ahEF5S\",\"mixedList\":\"_3ywn3JAC\",\"simpleList\":\"_1_g3vGe1\",\"download\":\"_32GZt2RY\"};\n\n/***/ },\n/* 33 */,\n/* 34 */,\n/* 35 */,\n/* 36 */,\n/* 37 */,\n/* 38 */,\n/* 39 */,\n/* 40 */,\n/* 41 */,\n/* 42 */,\n/* 43 */,\n/* 44 */,\n/* 45 */,\n/* 46 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar map = {\n\t\t\"./CourseMessageRender.tsx\": 52,\n\t\t\"./FansMessageRender.tsx\": 53,\n\t\t\"./MagazineMessageRender.tsx\": 54,\n\t\t\"./ReplyMessageRender.tsx\": 55,\n\t\t\"./SystemMessageRender.tsx\": 56\n\t};\n\tfunction webpackContext(req) {\n\t\treturn __webpack_require__(webpackContextResolve(req));\n\t};\n\tfunction webpackContextResolve(req) {\n\t\treturn map[req] || (function() { throw new Error(\"Cannot find module '\" + req + \"'.\") }());\n\t};\n\twebpackContext.keys = function webpackContextKeys() {\n\t\treturn Object.keys(map);\n\t};\n\twebpackContext.resolve = webpackContextResolve;\n\tmodule.exports = webpackContext;\n\twebpackContext.id = 46;\n\n\n/***/ },\n/* 47 */,\n/* 48 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar __extends = undefined && undefined.__extends || function (d, b) {\n\t    for (var p in b) {\n\t        if (b.hasOwnProperty(p)) d[p] = b[p];\n\t    }function __() {\n\t        this.constructor = d;\n\t    }\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t};\n\tvar parts_1 = __webpack_require__(4);\n\tvar App = function (_super) {\n\t    __extends(App, _super);\n\t    function App() {\n\t        _super.apply(this, arguments);\n\t    }\n\t    // The getChildContext function will be called when the state or props changes\n\t    App.prototype.getChildContext = function () {\n\t        return { title: '消息中心' };\n\t    };\n\t    App.prototype.render = function () {\n\t        return this.props.children;\n\t    };\n\t    // 全局的配置可以通过 Context 实现  https://facebook.github.io/react/docs/context.html\n\t    App.childContextTypes = {\n\t        title: parts_1.React.PropTypes.string\n\t    };\n\t    return App;\n\t}(parts_1.Component);\n\texports.App = App;\n\n/***/ },\n/* 49 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar __extends = undefined && undefined.__extends || function (d, b) {\n\t    for (var p in b) {\n\t        if (b.hasOwnProperty(p)) d[p] = b[p];\n\t    }function __() {\n\t        this.constructor = d;\n\t    }\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t};\n\tvar parts_1 = __webpack_require__(4);\n\tvar react_router_1 = __webpack_require__(14);\n\tvar style = __webpack_require__(72);\n\tvar Header = function (_super) {\n\t    __extends(Header, _super);\n\t    function Header() {\n\t        _super.apply(this, arguments);\n\t    }\n\t    Header.prototype.back = function () {\n\t        react_router_1.browserHistory.goBack();\n\t    };\n\t    Header.prototype.componentDidMount = function () {\n\t        var _a = this,\n\t            props = _a.props,\n\t            isClient = _a.isClient;\n\t        if (isClient && document.title !== props.title) {\n\t            document.title = props.title;\n\t        }\n\t    };\n\t    Header.prototype.render = function () {\n\t        return parts_1.React.createElement(\"div\", { className: this.classSet('no-select', style.header) }, parts_1.React.createElement(\"a\", { className: this.classSet('icon-carat-w text-hide', style.back), onClick: this.back.bind(this) }, \"Back\"), parts_1.React.createElement(\"div\", { className: this.classSet(style.title) }, this.props.title));\n\t    };\n\t    return Header;\n\t}(parts_1.Component);\n\texports.Header = Header;\n\n/***/ },\n/* 50 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar __extends = undefined && undefined.__extends || function (d, b) {\n\t    for (var p in b) {\n\t        if (b.hasOwnProperty(p)) d[p] = b[p];\n\t    }function __() {\n\t        this.constructor = d;\n\t    }\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t};\n\tvar parts_1 = __webpack_require__(4);\n\tvar style = __webpack_require__(73);\n\tvar Loading = function (_super) {\n\t    __extends(Loading, _super);\n\t    function Loading() {\n\t        _super.apply(this, arguments);\n\t    }\n\t    Loading.prototype.componentDidMount = function () {\n\t        var _this = this;\n\t        this._isMounded = true;\n\t        var load = this.props.load;\n\t        var el = parts_1.findDOMNode(this.refs['el']);\n\t        if (!load || !el || this.isServer) return;\n\t        var isHandleing, handler, done;\n\t        var screenHeight = window.innerHeight;\n\t        done = function done(finished) {\n\t            if (finished === void 0) {\n\t                finished = false;\n\t            }\n\t            isHandleing = false;\n\t            // 等到异步回来组件可能已经不在了\n\t            if (!_this._isMounded) {\n\t                return _this.unhandle();\n\t            }\n\t            if (finished) {\n\t                _this.setState({ finished: finished });\n\t            } else {\n\t                handler(); // 加载完后再确认一下，以免加载完后没有覆盖一屏\n\t            }\n\t        };\n\t        // handler 可能被其它组件通过调用 forceLoad 执行\n\t        handler = function handler() {\n\t            if (!_this._isMounded || isHandleing || _this.state.finished) return;\n\t            var _a = el.getBoundingClientRect(),\n\t                top = _a.top,\n\t                bottom = _a.bottom;\n\t            if (top <= screenHeight || bottom <= screenHeight) {\n\t                isHandleing = true;\n\t                load(done);\n\t            }\n\t        };\n\t        handler(); // 初始化需要执行下 handler，以拉取初始数据\n\t        this.handle(handler);\n\t    };\n\t    Loading.prototype.reload = function () {\n\t        var _this = this;\n\t        this.setState({ finished: false }, function () {\n\t            _this.componentDidMount();\n\t        });\n\t    };\n\t    Loading.prototype.handle = function (handler) {\n\t        if (this._handler !== handler) {\n\t            this.unhandle();\n\t            this._handler = handler;\n\t            // 虽然监听了 scroll，但不需要 throttle，因为内部用了 isHandleing 来过滤\n\t            window.addEventListener('scroll', handler);\n\t            window.addEventListener('resize', handler);\n\t        }\n\t    };\n\t    Loading.prototype.unhandle = function () {\n\t        if (this._handler) {\n\t            this._handler = null;\n\t            window.removeEventListener('resize', this._handler);\n\t            window.removeEventListener('scroll', this._handler);\n\t        }\n\t    };\n\t    Loading.prototype.componentWillUnmount = function () {\n\t        this.unhandle();\n\t        _super.prototype.componentWillUnmount.call(this);\n\t        this._isMounded = false;\n\t    };\n\t    Loading.prototype.render = function () {\n\t        var _a = this.props,\n\t            hide = _a.hide,\n\t            message = _a.message;\n\t        var finished = this.state.finished;\n\t        if (hide) return parts_1.React.createElement(\"div\", null);\n\t        return parts_1.React.createElement(\"div\", { ref: 'el', className: this.classSet('no-select', style.loading, finished && style.finished) }, finished ? message || '没有更多了' : parts_1.React.createElement(\"i\", { className: 'icon-spin5 spin ' + style.spin }));\n\t    };\n\t    return Loading;\n\t}(parts_1.Component);\n\texports.Loading = Loading;\n\n/***/ },\n/* 51 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar __extends = undefined && undefined.__extends || function (d, b) {\n\t    for (var p in b) {\n\t        if (b.hasOwnProperty(p)) d[p] = b[p];\n\t    }function __() {\n\t        this.constructor = d;\n\t    }\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t};\n\tvar parts_1 = __webpack_require__(4);\n\tvar MessageFactory_1 = __webpack_require__(15);\n\tvar MessageBuilder = function (_super) {\n\t    __extends(MessageBuilder, _super);\n\t    function MessageBuilder() {\n\t        _super.apply(this, arguments);\n\t    }\n\t    MessageBuilder.prototype.render = function () {\n\t        var message = this.props.message;\n\t        var component = MessageFactory_1.MessageFactory.getComponent(message.type);\n\t        if (!component) {\n\t            console.error('Not found component for %o', message);\n\t            return null;\n\t        }\n\t        return parts_1.React.createElement(component, this.props);\n\t    };\n\t    return MessageBuilder;\n\t}(parts_1.Component);\n\texports.MessageBuilder = MessageBuilder;\n\n/***/ },\n/* 52 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar __extends = undefined && undefined.__extends || function (d, b) {\n\t    for (var p in b) {\n\t        if (b.hasOwnProperty(p)) d[p] = b[p];\n\t    }function __() {\n\t        this.constructor = d;\n\t    }\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t};\n\tvar parts_1 = __webpack_require__(4);\n\tvar types_1 = __webpack_require__(7);\n\tvar MessageRender_1 = __webpack_require__(11);\n\tvar style = __webpack_require__(31);\n\tvar CourseMessageRender = function (_super) {\n\t    __extends(CourseMessageRender, _super);\n\t    function CourseMessageRender() {\n\t        _super.apply(this, arguments);\n\t    }\n\t    CourseMessageRender.prototype.render = function () {\n\t        var m = this.props.message;\n\t        return parts_1.React.createElement(\"div\", { className: this.classSet(style.item, 'flex') }, parts_1.React.createElement(\"div\", { className: style.cover }, parts_1.React.createElement(\"img\", { className: style.cover, src: m.cover })), parts_1.React.createElement(\"div\", { className: style.body, \"data-flex\": '1' }, parts_1.React.createElement(\"a\", { href: m.link, className: style.link }, parts_1.React.createElement(\"h3\", { \"data-clamp\": '2', className: style.title }, m.title), parts_1.React.createElement(\"div\", { className: 'clearfix' }, parts_1.React.createElement(\"span\", { className: 'pull-left ' + style.time }, parts_1.humanTime(m.createTime))), parts_1.React.createElement(\"p\", { \"data-clamp\": '2', className: style.content }, m.content)), this.renderExternal()));\n\t    };\n\t    CourseMessageRender.type = types_1.Type.Course;\n\t    return CourseMessageRender;\n\t}(MessageRender_1.MessageRender);\n\texports.CourseMessageRender = CourseMessageRender;\n\n/***/ },\n/* 53 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar __extends = undefined && undefined.__extends || function (d, b) {\n\t    for (var p in b) {\n\t        if (b.hasOwnProperty(p)) d[p] = b[p];\n\t    }function __() {\n\t        this.constructor = d;\n\t    }\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t};\n\tvar parts_1 = __webpack_require__(4);\n\tvar types_1 = __webpack_require__(7);\n\tvar MessageRender_1 = __webpack_require__(11);\n\tvar style = __webpack_require__(30);\n\tvar FansMessageRender = function (_super) {\n\t    __extends(FansMessageRender, _super);\n\t    function FansMessageRender() {\n\t        _super.apply(this, arguments);\n\t    }\n\t    FansMessageRender.prototype.render = function () {\n\t        var m = this.props.message;\n\t        var fans = m.fans,\n\t            len = fans.length,\n\t            firstFan = fans[0].name;\n\t        var content = '“' + firstFan + '”' + (len === 1 ? '' : '等' + len + '人') + '成为了你的粉丝';\n\t        return parts_1.React.createElement(\"div\", { className: style.item }, parts_1.React.createElement(\"div\", { className: style.follows + ' text-ellipsis' }, fans.map(function (fan, index) {\n\t            return parts_1.React.createElement(\"img\", { className: style.follow, key: index, src: fan.avatar });\n\t        })), parts_1.React.createElement(\"p\", { className: style.content }, content), parts_1.React.createElement(\"span\", { className: style.time }, parts_1.humanTime(m.createTime)), this.renderExternal());\n\t    };\n\t    FansMessageRender.type = types_1.Type.Fans;\n\t    return FansMessageRender;\n\t}(MessageRender_1.MessageRender);\n\texports.FansMessageRender = FansMessageRender;\n\n/***/ },\n/* 54 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar __extends = undefined && undefined.__extends || function (d, b) {\n\t    for (var p in b) {\n\t        if (b.hasOwnProperty(p)) d[p] = b[p];\n\t    }function __() {\n\t        this.constructor = d;\n\t    }\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t};\n\tvar parts_1 = __webpack_require__(4);\n\tvar types_1 = __webpack_require__(7);\n\tvar MessageRender_1 = __webpack_require__(11);\n\tvar style = __webpack_require__(31);\n\tvar MagazineMessageRender = function (_super) {\n\t    __extends(MagazineMessageRender, _super);\n\t    function MagazineMessageRender() {\n\t        _super.apply(this, arguments);\n\t    }\n\t    MagazineMessageRender.prototype.render = function () {\n\t        var m = this.props.message;\n\t        return parts_1.React.createElement(\"div\", { className: this.classSet(style.item, 'flex') }, parts_1.React.createElement(\"div\", { className: style.cover }, parts_1.React.createElement(\"img\", { className: style.cover, src: m.cover })), parts_1.React.createElement(\"div\", { className: style.body, \"data-flex\": '1' }, parts_1.React.createElement(\"a\", { href: m.link, className: style.link }, parts_1.React.createElement(\"h3\", { \"data-clamp\": '2', className: style.title }, m.title), parts_1.React.createElement(\"div\", { className: 'clearfix' }, parts_1.React.createElement(\"span\", { className: 'pull-left ' + style.time }, parts_1.humanTime(m.createTime)), parts_1.React.createElement(\"span\", { className: 'pull-right ' + style.time }, \"更新\", m.series, \"期\"))), this.renderExternal()));\n\t    };\n\t    MagazineMessageRender.type = types_1.Type.Magazine;\n\t    return MagazineMessageRender;\n\t}(MessageRender_1.MessageRender);\n\texports.MagazineMessageRender = MagazineMessageRender;\n\n/***/ },\n/* 55 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar __extends = undefined && undefined.__extends || function (d, b) {\n\t    for (var p in b) {\n\t        if (b.hasOwnProperty(p)) d[p] = b[p];\n\t    }function __() {\n\t        this.constructor = d;\n\t    }\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t};\n\tvar parts_1 = __webpack_require__(4);\n\tvar types_1 = __webpack_require__(7);\n\tvar MessageRender_1 = __webpack_require__(11);\n\tvar style = __webpack_require__(30);\n\tvar ReplyMessageRender = function (_super) {\n\t    __extends(ReplyMessageRender, _super);\n\t    function ReplyMessageRender() {\n\t        _super.apply(this, arguments);\n\t    }\n\t    ReplyMessageRender.prototype.render = function () {\n\t        var m = this.props.message;\n\t        return parts_1.React.createElement(\"div\", { className: style.item }, this.renderCommunityUser(m.from, parts_1.humanTime(m.createTime), style), parts_1.React.createElement(\"p\", { \"data-clamp\": '2', className: style.content }, m.answer), parts_1.React.createElement(\"div\", { className: style.grayBackground }, parts_1.React.createElement(\"p\", { \"data-clamp\": '2', className: style.title }, m.title)), this.renderExternal());\n\t    };\n\t    ReplyMessageRender.type = types_1.Type.Reply;\n\t    return ReplyMessageRender;\n\t}(MessageRender_1.MessageRender);\n\texports.ReplyMessageRender = ReplyMessageRender;\n\n/***/ },\n/* 56 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar __extends = undefined && undefined.__extends || function (d, b) {\n\t    for (var p in b) {\n\t        if (b.hasOwnProperty(p)) d[p] = b[p];\n\t    }function __() {\n\t        this.constructor = d;\n\t    }\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t};\n\tvar parts_1 = __webpack_require__(4);\n\tvar types_1 = __webpack_require__(7);\n\tvar MessageRender_1 = __webpack_require__(11);\n\tvar style = __webpack_require__(75);\n\tvar SystemMessageRender = function (_super) {\n\t    __extends(SystemMessageRender, _super);\n\t    function SystemMessageRender(props) {\n\t        _super.call(this, props);\n\t        this.state.clamp = '2';\n\t    }\n\t    SystemMessageRender.prototype.handleClick = function () {\n\t        var clamp = this.state.clamp;\n\t        this.setState({ clamp: clamp ? '' : '2' });\n\t    };\n\t    SystemMessageRender.prototype.render = function () {\n\t        var m = this.props.message;\n\t        var clamp = this.state.clamp;\n\t        return parts_1.React.createElement(\"div\", { className: style.item }, parts_1.React.createElement(\"p\", { onClick: this.handleClick.bind(this), className: style.title, \"data-clamp\": clamp }, m.title), parts_1.React.createElement(\"span\", { className: style.time }, parts_1.humanTime(m.createTime)), this.renderExternal());\n\t    };\n\t    SystemMessageRender.type = types_1.Type.System;\n\t    return SystemMessageRender;\n\t}(MessageRender_1.MessageRender);\n\texports.SystemMessageRender = SystemMessageRender;\n\n/***/ },\n/* 57 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar __extends = undefined && undefined.__extends || function (d, b) {\n\t    for (var p in b) {\n\t        if (b.hasOwnProperty(p)) d[p] = b[p];\n\t    }function __() {\n\t        this.constructor = d;\n\t    }\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t};\n\tvar parts_1 = __webpack_require__(4);\n\tvar _1 = __webpack_require__(26);\n\tvar MessageGroup_1 = __webpack_require__(27);\n\tvar parts_2 = __webpack_require__(4);\n\tvar style = __webpack_require__(32);\n\tvar MixedMessageGroup = function (_super) {\n\t    __extends(MixedMessageGroup, _super);\n\t    function MixedMessageGroup() {\n\t        _super.apply(this, arguments);\n\t    }\n\t    /**\r\n\t     * isomorphic 函数只能写在 react-router 的 handle component 中\r\n\t     *\r\n\t     * 非 handle component（如 Header, Nav）无法执行到，所以如果是这些\r\n\t     * 的组件需要用 ajax，那么，最好是将 ajax 提取到 handle component，\r\n\t     * 然后通过 props 的方式将数据传给子组件。\r\n\t     *\r\n\t     * 这些 ajax 请求最好也不能依赖除了 url 相关的数据以外的其它所有资源。\r\n\t     *\r\n\t     * 此函数除第一个参数之外的其它参数都是为了方便客户端复用而添加的，也就是说\r\n\t     * 服务端在调用的时候只会提供第一个参数，且这个参数是 react-router 生成的。\r\n\t     */\n\t    MixedMessageGroup.isomorphic = function (props, _clientState) {\n\t        var state = _clientState || MessageGroup_1.MessageGroup.createInitState();\n\t        var page = state.page,\n\t            pageSize = state.pageSize,\n\t            messages = state.messages,\n\t            hideLoading = state.hideLoading;\n\t        var _a = props.params,\n\t            business = _a.business,\n\t            category = _a.category;\n\t        page++;\n\t        // return Promise.resolve(props);\n\t        return parts_1.api.getCagegoryMessages({ business: business, category: category, page: page, pageSize: pageSize }).then(function (data) {\n\t            var collection = data.collection,\n\t                page = data.page,\n\t                total = data.total,\n\t                unread = data.unread;\n\t            // 只需要第一次设置成功即可，之后 data 是从缓存中来的，不准确\n\t            parts_1.setServerTime(data.now);\n\t            messages.push.apply(messages, collection);\n\t            var size = messages.length;\n\t            // 如果总数量不超过一屏，则不需要显示加载条\n\t            hideLoading = size && size < pageSize;\n\t            // 因为 HTTP 缓存，所以得到的 dots[k] 要处理下\n\t            var dots = parts_1.store.get('dots', {});\n\t            Object.keys(unread.category).forEach(function (k) {\n\t                if (k === category) dots[k] = 0; // 当前 tab 不需要出现红点\n\t                else if (dots[k] !== 0) dots[k] = unread.category[k];\n\t            });\n\t            parts_1.store.set('dots', dots);\n\t            var state = { page: page, messages: messages, hideLoading: hideLoading, total: total, unread: unread.business };\n\t            // 如果是在服务端渲染，修改组件的初始状态\n\t            if (!_clientState) {\n\t                MixedMessageGroup.initState = state;\n\t            }\n\t            return Promise.resolve(state);\n\t        });\n\t    };\n\t    MixedMessageGroup.prototype.load = function (done) {\n\t        var _this = this;\n\t        var _a = this,\n\t            props = _a.props,\n\t            state = _a.state;\n\t        this.getConstructor().isomorphic(props, state).then(function (state) {\n\t            if (_this._isMounted) {\n\t                _this.setState(state);\n\t                done(state.messages.length >= state.total);\n\t            }\n\t        });\n\t    };\n\t    MixedMessageGroup.prototype.getMessageList = function () {\n\t        var _a = this.state,\n\t            messages = _a.messages,\n\t            unread = _a.unread;\n\t        var _b = this.props.params,\n\t            business = _b.business,\n\t            category = _b.category;\n\t        return messages.map(function (message) {\n\t            return parts_1.React.createElement(_1.MessageBuilder, { key: message.id, business: business, category: category, message: message, unread: unread });\n\t        });\n\t    };\n\t    MixedMessageGroup.prototype.componentWillReceiveProps = function (props) {\n\t        var _this = this;\n\t        var state = MessageGroup_1.MessageGroup.createInitState();\n\t        this.setState(state, function () {\n\t            _this.refs.loading.reload();\n\t        });\n\t    };\n\t    MixedMessageGroup.prototype.render = function () {\n\t        var dots = parts_1.store.get('dots');\n\t        var _a = this,\n\t            load = _a.load,\n\t            _b = _a.state,\n\t            hideLoading = _b.hideLoading,\n\t            unread = _b.unread,\n\t            business = _a.props.params.business;\n\t        return parts_1.React.createElement(\"div\", null, parts_1.React.createElement(parts_2.Header, { title: this.context.title }), parts_1.React.createElement(parts_2.Nav, { business: business, dots: dots }), parts_1.React.createElement(\"div\", { className: this.classSet(style.list, style.mixedList) }, this.getMessageList()), parts_1.React.createElement(parts_2.Loading, { ref: 'loading', hide: hideLoading, load: load.bind(this) }));\n\t    };\n\t    MixedMessageGroup.contextTypes = {\n\t        title: parts_1.React.PropTypes.string\n\t    };\n\t    return MixedMessageGroup;\n\t}(MessageGroup_1.MessageGroup);\n\texports.MixedMessageGroup = MixedMessageGroup;\n\n/***/ },\n/* 58 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar __extends = undefined && undefined.__extends || function (d, b) {\n\t    for (var p in b) {\n\t        if (b.hasOwnProperty(p)) d[p] = b[p];\n\t    }function __() {\n\t        this.constructor = d;\n\t    }\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t};\n\tvar parts_1 = __webpack_require__(4);\n\tvar types_1 = __webpack_require__(7);\n\tvar _1 = __webpack_require__(26);\n\tvar MessageGroup_1 = __webpack_require__(27);\n\tvar style = __webpack_require__(32);\n\tvar SimpleMessageGroup = function (_super) {\n\t    __extends(SimpleMessageGroup, _super);\n\t    function SimpleMessageGroup() {\n\t        _super.apply(this, arguments);\n\t    }\n\t    SimpleMessageGroup.isomorphic = function (props, _clientState) {\n\t        var state = _clientState || MessageGroup_1.MessageGroup.createInitState();\n\t        var page = state.page,\n\t            pageSize = state.pageSize,\n\t            messages = state.messages,\n\t            hideLoading = state.hideLoading;\n\t        var _a = props.params,\n\t            business = _a.subBusiness,\n\t            category = _a.category;\n\t        page++;\n\t        return parts_1.api.getBusinessUnreadMessages({ category: category, business: business }).then(function (data) {\n\t            var messages = data.collection;\n\t            var hideLoading = !!messages.length; // 当显示数量为 0 时，还是要显示进度条（这时进度条显示的是“没有更多数据了”之类的）\n\t            var showAppBanner = hideLoading && data.total > messages.length;\n\t            parts_1.setServerTime(data.now);\n\t            var state = { messages: messages, hideLoading: hideLoading, showAppBanner: showAppBanner, page: page, pageSize: pageSize };\n\t            if (!_clientState) {\n\t                SimpleMessageGroup.initState = state;\n\t            }\n\t            return Promise.resolve(state);\n\t        });\n\t    };\n\t    SimpleMessageGroup.prototype.getMessageList = function () {\n\t        return this.state.messages.map(function (message) {\n\t            return parts_1.React.createElement(_1.MessageBuilder, { key: message.id, message: message });\n\t        });\n\t    };\n\t    SimpleMessageGroup.prototype.load = function (done) {\n\t        var _this = this;\n\t        var _a = this,\n\t            props = _a.props,\n\t            state = _a.state;\n\t        /*\r\n\t          只执行一次，因为会有这么一个 BUG:\r\n\t          拉取第一屏，并将这一屏的消息设置成已读，再回退到上一页面，再进来，消息数量就不是外面显示的数量了；\r\n\t          如果不将消息设置成已读，那么消息无法读完。\r\n\t                解决方案：\r\n\t          永远只拉取一屏消息，不要将这些消息设置成已读，回去后，再进来看到的都是一样（因为有 http 缓存），\r\n\t          除非刷新页面\r\n\t         */\n\t        if (state.page > 0) return done(true);\n\t        this.getConstructor().isomorphic(props, state, done).then(function (state) {\n\t            if (_this._isMounted) {\n\t                _this.setState(state);\n\t                done(true);\n\t            }\n\t        });\n\t    };\n\t    SimpleMessageGroup.prototype.render = function () {\n\t        var _a = this,\n\t            load = _a.load,\n\t            _b = _a.state,\n\t            hideLoading = _b.hideLoading,\n\t            showAppBanner = _b.showAppBanner;\n\t        var _c = this.props.params,\n\t            category = _c.category,\n\t            business = _c.subBusiness;\n\t        var app = types_1.BusinessMap[business];\n\t        var title = types_1.CategoryMap[category] + ' - ' + app;\n\t        return parts_1.React.createElement(\"div\", null, parts_1.React.createElement(parts_1.Header, { title: title }), parts_1.React.createElement(\"div\", { className: this.classSet(style.list, style.simpleList) }, this.getMessageList()), parts_1.React.createElement(parts_1.Loading, { hide: hideLoading, load: load.bind(this) }), showAppBanner && parts_1.React.createElement(\"a\", { className: style.download, href: 'http://m.hujiang.com/app/' }, \"查看更多消息，请下载\", app, \"客户端 > \"));\n\t    };\n\t    return SimpleMessageGroup;\n\t}(MessageGroup_1.MessageGroup);\n\texports.SimpleMessageGroup = SimpleMessageGroup;\n\n/***/ },\n/* 59 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tfunction __export(m) {\n\t    for (var p in m) {\n\t        if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n\t    }\n\t}\n\t__export(__webpack_require__(57));\n\t__export(__webpack_require__(58));\n\n/***/ },\n/* 60 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar __extends = undefined && undefined.__extends || function (d, b) {\n\t    for (var p in b) {\n\t        if (b.hasOwnProperty(p)) d[p] = b[p];\n\t    }function __() {\n\t        this.constructor = d;\n\t    }\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t};\n\tvar parts_1 = __webpack_require__(4);\n\tvar types_1 = __webpack_require__(7);\n\tvar react_router_1 = __webpack_require__(14);\n\tvar style = __webpack_require__(76);\n\tvar Nav = function (_super) {\n\t    __extends(Nav, _super);\n\t    function Nav() {\n\t        _super.apply(this, arguments);\n\t    }\n\t    Nav.prototype.render = function () {\n\t        var _a = this.props,\n\t            business = _a.business,\n\t            _b = _a.dots,\n\t            dots = _b === void 0 ? {} : _b;\n\t        var children = types_1.CategoryKeys.map(function (key) {\n\t            var label = types_1.CategoryMap[key];\n\t            var path = \"/\" + business + \"/\" + key;\n\t            return parts_1.React.createElement(\"li\", { \"data-flex\": '1', key: key, className: dots[key] ? style.dot : null }, parts_1.React.createElement(react_router_1.Link, { to: path, className: style.link, activeClassName: style.active }, label));\n\t        });\n\t        return parts_1.React.createElement(\"ul\", { className: 'flex ' + style.nav }, children);\n\t    };\n\t    return Nav;\n\t}(parts_1.Component);\n\texports.Nav = Nav;\n\n/***/ },\n/* 61 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar elegantApi = __webpack_require__(29);\n\tvar _1 = __webpack_require__(66);\n\texports.api = elegantApi({\n\t    base: '/api/messages',\n\t    // 去除 request 和 response 所有格式化的规则\n\t    response: { order: [] },\n\t    request: { order: [] },\n\t    cache: {\n\t        enable: 'smart',\n\t        expireSeconds:  false ? 10 : 0 // 服务端只需要 10s 的短暂的缓存，客户端无限缓存\n\t    },\n\t    dataTransformMethod: 'cookie',\n\t    mock: {\n\t        memory: (false) || (false),\n\t        server:  true ? 'self' : null\n\t    },\n\t    handle: function handle(target, cb) {\n\t        var routeName = this.name;\n\t        if (true) {\n\t            console.log(\"%c\" + routeName + \"%c \" + target.http.url + \" %o\", 'color:green; background:yellow;', 'color:red', target);\n\t        }\n\t        var done = function done(rtnData, error, cb) {\n\t            var d = rtnData || {};\n\t            var data = d.data,\n\t                message = d.message,\n\t                status = d.status;\n\t            var errorMessage, oldError;\n\t            if (error) {\n\t                errorMessage = '网络异常，请稍后再试';\n\t                oldError = error;\n\t                status = -1;\n\t                console.log(oldError);\n\t            } else if (status !== 0) {\n\t                errorMessage = message || '未知错误，状态码 ' + status;\n\t            }\n\t            if (errorMessage) {\n\t                error = new Error(errorMessage);\n\t                error.status = status;\n\t                error.message = errorMessage;\n\t                error.oldError = oldError;\n\t            }\n\t            return cb(error, data);\n\t        };\n\t        var data = target.data,\n\t            http = target.http,\n\t            error = target.error;\n\t        var method = http.method,\n\t            url = http.url;\n\t        delete http.crossOrigin;\n\t        delete http.dataType;\n\t        if (method === 'HEAD' || method === 'GET') {\n\t            delete http['body']; // 不删除会导致火狐下报错\n\t        } else if (method === 'POST' || method === 'DELETE') {\n\t                http['body'] = JSON.stringify(http['body']);\n\t            }\n\t        if (this.mock.memory) return done(data, error, cb);\n\t        fetch(http.url, http).then(function (res) {\n\t            var status = res.status;\n\t            if (status >= 200 && status < 300) {\n\t                return res.json();\n\t            } else {\n\t                var err = new Error('STATUS NOT OK');\n\t                err['response'] = res;\n\t                throw err;\n\t            }\n\t        }).then(function (data) {\n\t            return done(data, null, cb);\n\t        }).catch(function (err) {\n\t            return done(null, err, cb);\n\t        });\n\t    },\n\t    routes: {\n\t        // 获取某一个大类的所有消息\n\t        // 非指定的业务线只显示第一条\n\t        getCagegoryMessages: {\n\t            path: '/:category/:business',\n\t            query: 'page=1&pageSize=10'\n\t        },\n\t        // 从大类中进入的某一个具体的小类的所有消息\n\t        // 只显示指定的业务线，并且只显示未读消息\n\t        getBusinessUnreadMessages: {\n\t            path: '/group/:category/:business',\n\t            query: 'page=1&pageSize=10'\n\t        },\n\t        // 获取具体的某一条消息\n\t        getMessage: {\n\t            path: '/:id'\n\t        }\n\t    },\n\t    mocks: _1.mocks\n\t});\n\t// 在客户端\n\tif (typeof window !== 'undefined') {\n\t    (function () {\n\t        var win = window;\n\t        win.api = exports.api;\n\t        if (G && G.eaCache) {\n\t            exports.api.$cache(G.eaCache);\n\t        }\n\t    })();\n\t}\n\tvar types_1 = __webpack_require__(16);\n\texports.Category = types_1.Category;\n\texports.Business = types_1.Business;\n\texports.Type = types_1.Type;\n\n/***/ },\n/* 62 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tvar diffMillseconds;\n\t/**\r\n\t * 设置服务端时间，得到客户端时间和服务端时间之间\r\n\t */\n\tfunction setServerTime(time) {\n\t    if (diffMillseconds == null) {\n\t        diffMillseconds = time - Date.now();\n\t    }\n\t}\n\texports.setServerTime = setServerTime;\n\t/**\r\n\t * 获取当前服务器时间\r\n\t */\n\tfunction getServerTime() {\n\t    if (diffMillseconds == null) {\n\t        console.warn('Not set server time yet, using client time temporarily!');\n\t    }\n\t    return (diffMillseconds || 0) + Date.now();\n\t}\n\texports.getServerTime = getServerTime;\n\tfunction humanTime(lastTime) {\n\t    var lastDate, currentDate, diff;\n\t    var currentTime = getServerTime();\n\t    diff = Math.floor((currentTime - lastTime) / 60000); // 化成分钟\n\t    if (diff < 1) return '刚刚';\n\t    if (diff < 60) return diff + '分钟前'; // 60 分钟内\n\t    if (diff < 1440) return Math.floor(diff / 60) + '小时前'; // 1 小时 - 24 小时\n\t    if (diff < 14400) return Math.floor(diff / 1440) + '天前'; // 1 天 - 10 天\n\t    lastDate = new Date(lastTime);\n\t    currentDate = new Date(currentTime);\n\t    var year = lastDate.getFullYear(),\n\t        month = lastDate.getMonth() + 1,\n\t        day = lastDate.getDate(),\n\t        result = [month, day];\n\t    if (year !== currentDate.getFullYear()) result.unshift(year);\n\t    return result.join('-');\n\t}\n\texports.humanTime = humanTime;\n\n/***/ },\n/* 63 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tvar _storeData = {};\n\texports.store = {\n\t    get: function get(key, defaultVal) {\n\t        return key in _storeData ? _storeData[key] : defaultVal;\n\t    },\n\t    set: function set(key, val) {\n\t        _storeData[key] = val;\n\t    },\n\t    append: function append(key, items) {\n\t        var collection = this.get(key, []);\n\t        collection.push.apply(collection, items);\n\t        this.set(key, collection);\n\t    }\n\t};\n\n/***/ },\n/* 64 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t// https://github.com/reactjs/react-router/blob/master/docs/guides/RouteConfiguration.md\n\t\"use strict\";\n\t\n\tvar parts_1 = __webpack_require__(4);\n\tvar MessageGroup_1 = __webpack_require__(59);\n\tvar types_1 = __webpack_require__(7);\n\texports.routes = {\n\t    path: '/',\n\t    component: parts_1.App,\n\t    // indexRoute: { path: `/${dbk}/${dck}`, component: MixedMessageGroup },\n\t    // indexRoute: { onEnter(next, replace) { replace(`/${dbk}/${dck}`); } },\n\t    indexRoute: createRedirectIndexRoute(function (params) {\n\t        return \"/\" + types_1.defaultBusinessKey + \"/\" + types_1.defaultCategoryKey;\n\t    }),\n\t    childRoutes: [{\n\t        path: '/:business',\n\t        component: '',\n\t        indexRoute: createRedirectIndexRoute(function (params) {\n\t            return \"/\" + getBusiness(params.business) + \"/\" + types_1.defaultCategoryKey;\n\t        })\n\t    }, {\n\t        path: '/:business/:category',\n\t        component: MessageGroup_1.MixedMessageGroup,\n\t        indexRoute: createRedirectIndexRoute(function (params) {\n\t            var business = params.business,\n\t                category = params.category;\n\t            return \"/\" + getBusiness(business) + \"/\" + getCategory(category);\n\t        })\n\t    }, {\n\t        path: '/:business/:category/:subBusiness',\n\t        component: MessageGroup_1.SimpleMessageGroup,\n\t        indexRoute: createRedirectIndexRoute(function (params) {\n\t            var business = params.business,\n\t                category = params.category,\n\t                subBusiness = params.subBusiness;\n\t            return \"/\" + getBusiness(business) + \"/\" + getCategory(category) + \"/\" + getBusiness(subBusiness);\n\t        })\n\t    }]\n\t};\n\tfunction getBusiness(b) {\n\t    return b in types_1.BusinessMap ? b : types_1.defaultBusinessKey;\n\t}\n\tfunction getCategory(c) {\n\t    return c in types_1.CategoryMap ? c : types_1.defaultCategoryKey;\n\t}\n\tfunction createRedirectIndexRoute(cb) {\n\t    return {\n\t        onEnter: function onEnter(next, replace) {\n\t            var params = next.params,\n\t                _a = next.location,\n\t                pathname = _a.pathname,\n\t                search = _a.search;\n\t            var url = cb(params);\n\t            if (url && url !== pathname) return replace(url + search);\n\t            return false;\n\t        }\n\t    };\n\t}\n\n/***/ },\n/* 65 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/**\r\n\t * 数据生成器\r\n\t *\r\n\t * 本来可以引入第三方的数据生成器，但为了使文件 size 小点，还是自己写个精短版的\r\n\t */\n\t\"use strict\";\n\t\n\tvar types_1 = __webpack_require__(16);\n\tvar enumFamilyName = \"王李张刘陈杨赵黄周吴徐孙胡朱高林何郭马罗梁宋郑谢\\n韩唐冯于董萧程曹袁邓许傅沈曾彭吕苏卢蒋蔡贾丁魏薛叶阎余潘杜戴夏锺汪田任姜范\\n方石姚谭廖邹熊金陆郝孔白崔康毛邱秦江史顾侯邵孟龙万段雷钱汤尹黎易常武乔贺赖\\n龚文\".replace(/\\s/g, '').split('');\n\tvar enumGiveName = \"伟芳娜秀英敏静丽强磊军洋勇艳杰娟涛明超秀兰霞平刚桂英\".split('');\n\tvar enumText = \"人类长期只有口语用文字记录口语形成的书面语历史很短系统的语言成为人和禽兽分离的重要工具文字\".split('');\n\tvar enumAvatar = \"\\nd8bad2c0f825c92e0415a5d46c3d2fbe1\\nd8b2ba8cf572fba9f88e6f565e772714c\\nddc6410213bd2a6d782e3feaf31d389f3\\ndad84c291ff1f262000f96d36a8dd7ffc\\nd4f8fce2c1195a53d3e688d8f6a6614ce\\nd868f7175ff7f7e6c2e116988f6851f3b\\ndfb05cc71c257a8038932208222e9f8d2\\nd11258715ca4af94e73f28b6a6d51aac1\\ndcbb8effef6f889c2aaf3a5712dfe401b\\n\".trim().split(/\\s/).map(function (k) {\n\t    return \"http://cdn.llsapp.com/\" + k + \".jpg\";\n\t});\n\t// min <= x <= max\n\tfunction rand(min, max) {\n\t    if (min === void 0) {\n\t        min = 0;\n\t    }\n\t    if (max === void 0) {\n\t        max = 60;\n\t    }\n\t    return min + Math.floor(Math.random() * (max + 1 - min));\n\t}\n\tfunction sample(arg) {\n\t    var list = arg;\n\t    if (!Array.isArray(arg)) list = Object.keys(arg).map(function (k) {\n\t        return arg[k];\n\t    });\n\t    return list[rand(0, list.length - 1)];\n\t}\n\tfunction sampleEnumValue(arg) {\n\t    return sample(types_1.enumValues(arg));\n\t}\n\tfunction sampleEnumKey(arg) {\n\t    return sample(types_1.enumKeys(arg));\n\t}\n\tfunction text(min, max) {\n\t    if (min === void 0) {\n\t        min = 1;\n\t    }\n\t    if (max === void 0) {\n\t        max = 120;\n\t    }\n\t    var len = rand(min, max);\n\t    return fill(len, function () {\n\t        return sample(enumText);\n\t    }).join('');\n\t}\n\tfunction link(id) {\n\t    return 'http://www.baidu.com?id=' + id;\n\t}\n\tvar category = function category() {\n\t    return sampleEnumValue(types_1.Category);\n\t};\n\tvar business = function business() {\n\t    return sampleEnumValue(types_1.Business);\n\t};\n\tvar type = function type() {\n\t    return sampleEnumValue(types_1.Type);\n\t};\n\tvar bool = function bool() {\n\t    return rand(1, 100) > 50;\n\t};\n\tvar image = function image() {\n\t    return sample(enumAvatar);\n\t};\n\tvar now = Date.now();\n\tvar oneDay = 86400000;\n\tvar lastCreateTime = now - oneDay * 365;\n\tvar getCreateTime = function getCreateTime() {\n\t    lastCreateTime = lastCreateTime + Math.round((now - lastCreateTime) * Math.random());\n\t    return lastCreateTime;\n\t};\n\tvar lastId = 1;\n\texports.Generator = {\n\t    sampleEnumKey: sampleEnumKey,\n\t    sampleEnumValue: sampleEnumValue,\n\t    now: now, oneDay: oneDay,\n\t    rand: rand, sample: sample, fill: fill,\n\t    category: category, business: business, type: type,\n\t    Category: types_1.Category, Business: types_1.Business, Type: types_1.Type,\n\t    User: function User() {\n\t        var giveName = sample(enumGiveName);\n\t        if (bool()) giveName += sample(enumGiveName);\n\t        return {\n\t            name: sample(enumFamilyName) + giveName,\n\t            avatar: image()\n\t        };\n\t    },\n\t    Message: function Message() {\n\t        var createTime = getCreateTime();\n\t        var id = lastId++;\n\t        var isRead = bool();\n\t        return {\n\t            category: category(),\n\t            business: business(),\n\t            type: type(),\n\t            createTime: createTime,\n\t            id: id,\n\t            isRead: isRead,\n\t            readTime: isRead ? Math.min(now, createTime + Math.round(Math.random() * oneDay * 10)) : 0\n\t        };\n\t    },\n\t    SystemMessage: function SystemMessage() {\n\t        return message(function (m) {\n\t            m.category = types_1.Category.notice;\n\t            m.title = text();\n\t            m.type = types_1.Type.System;\n\t        });\n\t    },\n\t    ReplyMessage: function ReplyMessage() {\n\t        return message(function (m) {\n\t            m.category = types_1.Category.community;\n\t            m.title = text();\n\t            m.answer = text();\n\t            m.link = link(m.id);\n\t            m.from = user();\n\t            m.type = types_1.Type.Reply;\n\t        });\n\t    },\n\t    FansMessage: function FansMessage() {\n\t        return message(function (m) {\n\t            m.category = types_1.Category.community;\n\t            m.fans = fill(rand(1, 10), user);\n\t            m.type = types_1.Type.Fans;\n\t        });\n\t    },\n\t    CourseMessage: function CourseMessage() {\n\t        return message(function (m) {\n\t            m.category = types_1.Category.subscribe;\n\t            m.title = text();\n\t            m.content = text();\n\t            m.link = link(m.id);\n\t            m.type = types_1.Type.Course;\n\t            m.cover = image();\n\t        });\n\t    },\n\t    MagazineMessage: function MagazineMessage() {\n\t        return message(function (m) {\n\t            m.category = types_1.Category.subscribe;\n\t            m.title = text();\n\t            m.link = link(m.id);\n\t            m.series = rand(100, 9999);\n\t            m.type = types_1.Type.Magazine;\n\t            m.cover = image();\n\t        });\n\t    }\n\t};\n\tfunction user() {\n\t    return exports.Generator.User();\n\t}\n\tfunction message(cb) {\n\t    var m = exports.Generator.Message();\n\t    cb(m);\n\t    return m;\n\t}\n\tfunction fill(num, generate, context) {\n\t    var result = [];\n\t    for (var i = 0; i < num; i++) {\n\t        result.push(generate.call(context));\n\t    }return result;\n\t}\n\n/***/ },\n/* 66 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar types_1 = __webpack_require__(16);\n\tvar generator_1 = __webpack_require__(65);\n\tvar sample = generator_1.Generator.sample,\n\t    fill = generator_1.Generator.fill,\n\t    sampleEnumKey = generator_1.Generator.sampleEnumKey,\n\t    Type = generator_1.Generator.Type,\n\t    Business = generator_1.Generator.Business,\n\t    Category = generator_1.Generator.Category,\n\t    now = generator_1.Generator.now,\n\t    oneDay = generator_1.Generator.oneDay;\n\tvar TOTAL_MESSAGE = 1000; // 总消息数量\n\tvar TOTAL_READ_MESSAGE = 500; // 已读消息的数量\n\tvar MESSAGES = generator_1.Generator.fill(TOTAL_MESSAGE, function () {\n\t    return generator_1.Generator[sampleEnumKey(Type) + 'Message']();\n\t}).map(function (message, index) {\n\t    if (index < TOTAL_READ_MESSAGE) {\n\t        message.isRead = true;\n\t        message.readTime = Math.min(now, message.createTime + Math.round(Math.random() * oneDay * 10));\n\t    } else {\n\t        message.isRead = false;\n\t        message.readTime = 0;\n\t    }\n\t    return message;\n\t}).reverse();\n\tvar BUSINESS_MESSAGES = {};\n\tvar CATEGORY_MESSAGES = {};\n\tMESSAGES.forEach(function (message) {\n\t    save(message, Business, 'business', BUSINESS_MESSAGES);\n\t    save(message, Category, 'category', CATEGORY_MESSAGES);\n\t});\n\tfunction save(message, map, id, collection) {\n\t    var label = map[message[id]];\n\t    if (!collection[label]) collection[label] = [];\n\t    collection[label].push(message);\n\t}\n\tfunction getUnreadCountBy(id, map, collection) {\n\t    var result = {};\n\t    types_1.enumKeys(map).forEach(function (k) {\n\t        return result[k] = 0;\n\t    });\n\t    collection.forEach(function (message) {\n\t        if (!message.isRead) {\n\t            result[map[message[id]]]++;\n\t        }\n\t    });\n\t    return result;\n\t}\n\tfunction getUnreadCountByCategory(businessCollection) {\n\t    return getUnreadCountBy('category', Category, businessCollection);\n\t}\n\tfunction getUnreadCountByBusiness(categoryCollection) {\n\t    return getUnreadCountBy('business', Business, categoryCollection);\n\t}\n\t/**\r\n\t * 统一化返回的数据\r\n\t */\n\tfunction response(data, status, message) {\n\t    if (data === void 0) {\n\t        data = null;\n\t    }\n\t    if (status === void 0) {\n\t        status = 0;\n\t    }\n\t    if (message === void 0) {\n\t        message = '';\n\t    }\n\t    return { data: data, status: status, message: message };\n\t}\n\tfunction filter(category, business, query) {\n\t    var categoryCollection = CATEGORY_MESSAGES[category];\n\t    var businessCollection = BUSINESS_MESSAGES[business];\n\t    // 取出当前业务线上的消息，其它业务线只显示第一条\n\t    var map = {};\n\t    var collection = categoryCollection.filter(function (message) {\n\t        var mb = message.business;\n\t        if (mb in map) return false;\n\t        if (Business[mb] !== business) {\n\t            map[mb] = true;\n\t        }\n\t        return true;\n\t    });\n\t    var result = page(collection, query);\n\t    // NOTE: 这样每次刷新就都会出现红点，如果正式使用，需要去掉下面这行的注释\n\t    // read(categoryCollection, business);\n\t    result.unread = {\n\t        business: getUnreadCountByBusiness(categoryCollection),\n\t        category: getUnreadCountByCategory(businessCollection)\n\t    };\n\t    return result;\n\t}\n\tfunction page(collection, query) {\n\t    var total = collection.length;\n\t    var page = query.page,\n\t        pageSize = query.pageSize;\n\t    var now = Date.now();\n\t    page = parseInt(page, 10) || 1;\n\t    pageSize = parseInt(pageSize, 10) || 10;\n\t    collection = collection.slice((page - 1) * pageSize, page * pageSize);\n\t    return {\n\t        collection: collection, total: total, page: page, pageSize: pageSize, now: now\n\t    };\n\t}\n\tfunction read(collection, business) {\n\t    collection.forEach(function (message) {\n\t        if (Business[business] === message.business) {\n\t            message.isRead = true;\n\t            message.readTime = Date.now();\n\t        }\n\t    });\n\t}\n\tfunction checkCategory(category, callback) {\n\t    if (!category || !(category in Category)) {\n\t        callback(null, response(null, 500, 'category not exist or illegal'));\n\t        return false;\n\t    }\n\t    return true;\n\t}\n\tfunction checkBusinese(business, callback) {\n\t    if (!business || !(business in Business)) {\n\t        callback(null, response(null, 500, 'business not exist or illegal'));\n\t        return false;\n\t    }\n\t    return true;\n\t}\n\tfunction check(category, business, cb) {\n\t    return checkCategory(category, cb) && checkBusinese(business, cb);\n\t}\n\texports.mocks = {\n\t    /**\r\n\t     * 获取指定的 category 的所有消息\r\n\t     */\n\t    getCagegoryMessages: function getCagegoryMessages(target, callback) {\n\t        var query = target.query,\n\t            params = target.params;\n\t        var category = params.category,\n\t            business = params.business;\n\t        if (check(category, business, callback)) {\n\t            callback(null, response(filter(category, business, query)));\n\t        }\n\t    },\n\t    /**\r\n\t     * 获取指定的 business 的所有消息\r\n\t     */\n\t    getBusinessUnreadMessages: function getBusinessUnreadMessages(target, callback) {\n\t        var query = target.query,\n\t            params = target.params;\n\t        var business = params.business,\n\t            category = params.category;\n\t        if (check(category, business, callback)) {\n\t            var collection = CATEGORY_MESSAGES[category].filter(function (message) {\n\t                return !message.isRead && Business[message.business] === business;\n\t            });\n\t            callback(null, response(page(collection, query)));\n\t        }\n\t    },\n\t    /**\r\n\t     * 获取某一条消息\r\n\t     */\n\t    getMessage: function getMessage(target, callback) {\n\t        var id = parseInt(target.params.id),\n\t            found;\n\t        if (id) {\n\t            MESSAGES.forEach(function (message) {\n\t                if (message.id === id) {\n\t                    found = true;\n\t                    return callback(null, response(message));\n\t                }\n\t            });\n\t        }\n\t        if (!found) {\n\t            callback(null, response(null, 500, 'message not found or id not exist'));\n\t        }\n\t    },\n\t    $default: function $default(target, callback) {\n\t        callback(null, response());\n\t    }\n\t};\n\n/***/ },\n/* 67 */,\n/* 68 */,\n/* 69 */,\n/* 70 */,\n/* 71 */\n/***/ function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\n/***/ },\n/* 72 */\n/***/ function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\tmodule.exports = {\"header\":\"_3XuQ2892\",\"back\":\"_1_IIGf8k\",\"title\":\"_2jC9o7gf\"};\n\n/***/ },\n/* 73 */\n/***/ function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\tmodule.exports = {\"loading\":\"_2cm2hXUP\",\"finished\":\"AKumWgsl\",\"spin\":\"_3zXuHUyu\"};\n\n/***/ },\n/* 74 */\n/***/ function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\tmodule.exports = {\"from\":\"_1YLmEQ_b\",\"external\":\"_3ZSeCsqu\"};\n\n/***/ },\n/* 75 */\n/***/ function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\tmodule.exports = {\"item\":\"_1ZtHA02R\",\"title\":\"_1a13q_7p\",\"time\":\"_2z582xM4\"};\n\n/***/ },\n/* 76 */\n/***/ function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\tmodule.exports = {\"nav\":\"_1HJQLwR4\",\"link\":\"FuD-CNOa\",\"dot\":\"_8SVpk3Qg\",\"active\":\"_3zoFbV__\"};\n\n/***/ }\n]);\n\n\n/** WEBPACK FOOTER **\n ** main.c6da7a8b.js\n **/","require('./styles/common.scss'); // 最先加载样式\n\nimport {React, render} from './libs/base';\n\nimport {Router, browserHistory, hashHistory} from 'react-router';\nimport {routes} from './share/routes';\n\nlet history = __STANDALONE__ ? hashHistory : browserHistory;\nrender(<Router routes={routes} history={history} />, document.querySelector('main'));\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/tslint-loader!./client/main.tsx\n **/","export * from '../../libs/base';\nexport * from './App/App';\nexport * from './Header/Header';\nexport * from './Nav/Nav';\nexport * from './Loading/Loading';\n\nexport * from '../../libs/helper';\nexport * from '../../libs/store';\nexport * from '../../libs/api';\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/tslint-loader!./client/components/message/parts.tsx\n **/","export * from '../../../mock/types';\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/tslint-loader!./client/components/message/types.tsx\n **/","import {User, BusinessMap, Business, Message, BusinessUnreadCount} from '../types';\nimport { React, Component } from '../parts';\nimport { Link } from 'react-router';\nimport { MessageFactory } from './MessageFactory';\n\ninterface Props<M> {\n  message: M;\n\n  // 下面三个是 MixedMessageGroup 需要的\n  business?: string;\n  category?: string;\n  unread?: BusinessUnreadCount;\n}\n\nlet style = require('./renders/styles/common.scss?local');\n\nexport class MessageRender<M extends Message, S> extends Component<Props<M>, S> {\n  static type: number;\n\n  renderCommunityUser(user: User, humanTime: string, style: any) {\n    return <div className={style.user}>\n        <div className={style.avatar}>\n          <img className={style.avatarImg}  src={user.avatar} />\n        </div>\n        <div className={style.detail}>\n          <h3 className={style.username}>{user.name}</h3>\n          <span className={style.pubtime}>{humanTime}</span>\n        </div>\n      </div>;\n  }\n\n  renderExternal() {\n    let {message: m, business, category, unread} = this.props;\n    let key = Business[m.business],\n      label = BusinessMap[key];\n\n    if (key === business || !unread || !unread[key]) return null;\n\n    if (unread[key] === 1) {\n      return <p className={style.from}>来自{label}</p>;\n    } else {\n      let to = `/${business}/${category}/${key}`;\n      return <Link className={style.external} to={to}>{label}还有{unread[key]}条未读消息 &gt;</Link>;\n    }\n  }\n\n}\n\nexport function register(ctor: any) {\n  MessageFactory.registerComponent(ctor.type, ctor);\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/tslint-loader!./client/components/message/Message/MessageRender.tsx\n **/","let map: any = {};\n\nexport class MessageFactory {\n  static registerComponent(type: number, component: any) {\n    map[type] = component;\n  }\n\n  static getComponent(type: number) {\n    return map[type];\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/tslint-loader!./client/components/message/Message/MessageFactory.tsx\n **/","/*\n  * category 分类\n    - notice  通知类的消息\n    - subscribe 订阅类的消息\n    - community 社交类的消息\n\n  * business 业务线\n    - cctalk  CCTALK的消息\n    - hujiang 沪江学习的消息\n    - league  沪江辞场的消息\n    - hjclass 沪江网校的消息\n\n  * type 消息类型，类型决定了此消息包含的字段\n    - System 系统消息\n    - ...(这是会动态变化的，所以就不一一列出了，参见 enum Type)\n*/\n\nlet _reNumber = /^\\d+$/;\n\n/**\n * 消息的分类\n */\nexport enum Category {\n  notice = 1,\n  community,\n  subscribe\n}\n\nexport const CategoryMap = {\n  notice: '通知',\n  community: '社交',\n  subscribe: '订阅'\n};\n\n// 控制了 Nav 导航的顺序\nexport const CategoryKeys = ['notice', 'community', 'subscribe'];\nexport const defaultCategoryKey = CategoryKeys[0];\n\n\n\n/**\n * 消息所属业务线\n */\nexport enum Business {\n  cctalk = 1,\n  hujiang,\n  league,\n  hjclass\n}\n\nexport const BusinessMap = {\n  cctalk: 'CCTalk',\n  hujiang: '沪江学习',\n  league: '沪江词场',\n  hjclass: '沪江网校'\n};\n\nexport const BusinessKeys = enumKeys(Business);\nexport const defaultBusinessKey = BusinessKeys[0];\n\n\n\n/**\n * 消息各类\n *\n * 可以理解成 Category 的细分，不同的 Type 决定的消息的结构\n */\nexport enum Type {\n  // Notice\n  System = 1, // 系统消息\n\n  // Community\n  Reply, // 社交类的回复消息\n  Fans, // 粉丝提醒\n\n  // Subscribe\n  Course, // 课程内容更新\n  Magazine // 社团的期刊更新消息\n}\n\nexport declare type Link = string;\nexport declare type Timestamp = number;\n\nexport interface Message {\n  category: Category;\n  business: Business;\n  type: Type;\n\n  createTime: Timestamp;\n\n  id: number;\n  isRead: boolean; // 是否阅读过\n  readTime: Timestamp; // 如果消息未读，则为 0\n}\n\nexport interface User {\n  name: string;\n  avatar: Link;\n}\n\nexport interface SystemMessage extends Message {\n  title: string;\n}\n\nexport interface ReplyMessage extends Message {\n  title: string;\n  answer: string;\n  link: Link;\n  from: User;\n}\n\nexport interface FansMessage extends Message {\n  fans: Array<User>;\n}\n\nexport interface CourseMessage extends Message {\n  title: string;\n  content: string;\n  link: Link;\n  cover: string;\n}\n\nexport interface MagazineMessage extends Message {\n  title: string;\n  series: number;\n  link: Link;\n  cover: string;\n}\n\n\n//==================================\n//===== response 相关\n//==================================\n\n\nexport interface BusinessUnreadMessagesResponse {\n  collection: Message[];\n  total: number;\n  page: number;\n  pageSize: number;\n  now: number;\n}\n\nexport interface CagegoryMessagesResponse extends BusinessUnreadMessagesResponse {\n  unread: {\n    business: BusinessUnreadCount,\n    category: CategoryUnreadCount\n  };\n}\n\nexport interface BusinessUnreadCount {\n  cctalk: number;\n  hujiang: number;\n  league: number;\n  hjclass: number;\n}\n\nexport interface CategoryUnreadCount {\n  notice: number;\n  community: number;\n  subscribe: number;\n}\n\nexport interface MessageResponse extends Message {}\n\n\n//==================================\n//===== 其它 types\n//==================================\nexport interface ResponseData {\n  status: number;\n  data: any;\n  message: string;\n}\n\n\n// 实用函数\nexport function enumKeys(e) {\n  return Object.keys(e).filter(k => !_reNumber.test(k));\n}\n\nexport function enumValues(e) {\n  return Object.keys(e)\n    .filter(k => _reNumber.test(k))\n    .map(k => parseInt(k, 10));\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/tslint-loader!./mock/types.ts\n **/","import {MessageFactory} from './MessageFactory';\n\nlet ctx = require.context('./renders', true, /\\.tsx$/);\nctx.keys().forEach(key => {\n  if (/(\\w+)\\.tsx/.test(key)) {\n    let ctorName = RegExp.$1;\n    let ctor = ctx(key)[ctorName];\n    MessageFactory.registerComponent(ctor.type, ctor);\n  }\n});\n\nexport * from './MessageFactory';\nexport * from './MessageBuilder';\nexport * from './MessageRender';\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/tslint-loader!./client/components/message/Message/index.tsx\n **/","import { React, Component, setServerTime } from '../parts';\nimport { RouteComponentProps } from 'react-router';\nimport { MessageBuilder } from '../Message/';\n\nimport {Message} from '../types';\n\nexport interface MessageGroupProps extends RouteComponentProps<any, any> {}\nexport interface MessageGroupState {\n  messages?: Message[];\n  page?: number;\n  pageSize?: number;\n  hideLoading?: boolean;\n}\n\nexport abstract class MessageGroup<P extends MessageGroupProps, S extends MessageGroupState> extends Component<P, S> {\n\n  // 方便给 forServer 函数用\n  static initState: any;\n\n  protected _isMounted: boolean;\n\n  static createInitState(): any {\n    return {\n      messages: [],\n      page: 0,\n      pageSize: 10,\n      hideLoading: false\n    };\n  }\n\n  constructor(props) {\n    super(props);\n    let {params} = props;\n    this.state = this.getInitState();\n  }\n\n  getInitState(): any {\n    return this.getConstructor().initState || MessageGroup.createInitState();\n  }\n\n  componentDidMount() {\n    this._isMounted = true;\n  }\n  componentWillUnmount() {\n    super.componentWillUnmount();\n    this._isMounted = false;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/tslint-loader!./client/components/message/MessageGroup/MessageGroup.tsx\n **/","import * as React from 'react';\nimport {render, findDOMNode} from 'react-dom';\n\nconst isClient = typeof window !== 'undefined';\n\n\nclass Component<P, S> extends React.Component<P, S> {\n  isClient: boolean = isClient;\n  isServer: boolean = !isClient;\n  state: S;\n\n  constructor(props: P) {\n    super(props);\n    let initState: any = {};\n    this.state = initState;\n  }\n\n  getConstructor(): any {\n    return this.constructor;\n  }\n\n  componentWillUnmount() {\n    this.state = null;\n  }\n\n  classSet(...args): string {\n    let result = [];\n    args.forEach((arg) => {\n      if (arg) {\n        if (Array.isArray(arg)) result.push(this.classSet(...arg));\n        else if (typeof arg === 'string') result.push(arg);\n        else if (typeof arg === 'object') result.push(...(Object.keys(arg).filter(k => arg[k])));\n      }\n    });\n\n    return result.join(' ');\n  }\n}\n\nexport {\n  React,\n  Component,\n  render,\n  findDOMNode\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/tslint-loader!./client/libs/base.tsx\n **/","// removed by extract-text-webpack-plugin\nmodule.exports = {\"item\":\"_2B-f9hZJ\",\"follows\":\"_2RZvCCkc\",\"follow\":\"_1NdWkpm_\",\"content\":\"WvLqlPY4\",\"grayBackground\":\"Wdx77iE2\",\"title\":\"_2HeKYZEe\",\"time\":\"_2qoCqGt2\",\"user\":\"_1awaliRa\",\"avatar\":\"_1TuoDfl3\",\"avatarImg\":\"_2uGIXoAc\",\"detail\":\"BVDdfqVb\",\"username\":\"_3VrkeQKK\",\"pubtime\":\"_3niHB7o3\"};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./client/components/message/Message/renders/styles/community.scss?local\n ** module id = 30\n ** module chunks = 2\n **/","// removed by extract-text-webpack-plugin\nmodule.exports = {\"item\":\"_3i0McZiX\",\"cover\":\"_2UMXibsD\",\"body\":\"_3QZU8LU4\",\"link\":\"_32Wjc51I\",\"title\":\"_1frtJDd9\",\"time\":\"_3By44e0d\",\"content\":\"rBo7kFC4\"};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./client/components/message/Message/renders/styles/subscribe.scss?local\n ** module id = 31\n ** module chunks = 2\n **/","// removed by extract-text-webpack-plugin\nmodule.exports = {\"list\":\"P3ahEF5S\",\"mixedList\":\"_3ywn3JAC\",\"simpleList\":\"_1_g3vGe1\",\"download\":\"_32GZt2RY\"};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./client/components/message/MessageGroup/styles.scss?local\n ** module id = 32\n ** module chunks = 2\n **/","var map = {\n\t\"./CourseMessageRender.tsx\": 52,\n\t\"./FansMessageRender.tsx\": 53,\n\t\"./MagazineMessageRender.tsx\": 54,\n\t\"./ReplyMessageRender.tsx\": 55,\n\t\"./SystemMessageRender.tsx\": 56\n};\nfunction webpackContext(req) {\n\treturn __webpack_require__(webpackContextResolve(req));\n};\nfunction webpackContextResolve(req) {\n\treturn map[req] || (function() { throw new Error(\"Cannot find module '\" + req + \"'.\") }());\n};\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 46;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./client/components/message/Message/renders \\.tsx$\n ** module id = 46\n ** module chunks = 2\n **/","import { React, Component } from '../parts';\nimport { RouteComponentProps } from 'react-router';\n\n// params and routeParams\ninterface Props extends RouteComponentProps<any, any> {}\ninterface State  {}\n\nexport class App extends Component<Props, State> {\n\n  // 全局的配置可以通过 Context 实现  https://facebook.github.io/react/docs/context.html\n  static childContextTypes = {\n    title: React.PropTypes.string\n  };\n\n  // The getChildContext function will be called when the state or props changes\n  getChildContext() {\n    return { title: '消息中心' };\n  }\n\n  render() {\n    return this.props.children;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/tslint-loader!./client/components/message/App/App.tsx\n **/","import { React, Component } from '../parts';\nimport { browserHistory } from 'react-router';\n\ninterface Props extends React.Props<any> {\n  title: string;\n}\ninterface State  {}\n\nlet style = require('./header.scss?local');\n\nexport class Header extends Component<Props, State> {\n\n  back() {\n    browserHistory.goBack();\n  }\n\n  componentDidMount() {\n    let {props, isClient} = this;\n    if (isClient && document.title !== props.title) {\n      document.title = props.title;\n    }\n  }\n\n  render() {\n    return (\n      <div className={this.classSet('no-select', style.header)}>\n        <a className={this.classSet('icon-carat-w text-hide', style.back)} onClick={this.back.bind(this)}>Back</a>\n        <div className={this.classSet(style.title)}>{this.props.title}</div>\n      </div>\n    );\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/tslint-loader!./client/components/message/Header/Header.tsx\n **/","import { React, Component, findDOMNode } from '../parts';\n\ninterface Props extends React.Props<any> {\n  hide?: boolean;  // 隐藏加载条\n  message?: string; // 加载结束了可以显示此提示\n  load?: (finised?: boolean) => void; // 当 Loading 组件出现在浏览器视窗内时，就执行此函数\n}\ninterface State  {\n  finished?: boolean; // 是否加载结束了\n}\n\nlet style = require('./loading.scss?local');\n\n\nexport class Loading extends Component<Props, State> {\n  private _handler: any;\n  protected _isMounded: boolean;\n\n  componentDidMount() {\n    this._isMounded = true;\n\n    let {load} = this.props;\n    let el = findDOMNode(this.refs['el']);\n\n    if (!load || !el || this.isServer) return ;\n\n    let isHandleing, handler, done;\n    let screenHeight = window.innerHeight;\n\n    done = (finished: boolean = false) => {\n      isHandleing = false;\n\n      // 等到异步回来组件可能已经不在了\n      if (!this._isMounded) {\n        return this.unhandle();\n      }\n\n      if (finished) {\n        this.setState({finished});\n      } else {\n        handler(); // 加载完后再确认一下，以免加载完后没有覆盖一屏\n      }\n    };\n\n    // handler 可能被其它组件通过调用 forceLoad 执行\n    handler = () => {\n      if (!this._isMounded || isHandleing || this.state.finished) return ;\n\n      let {top, bottom} = el.getBoundingClientRect();\n      if (top <= screenHeight || bottom <= screenHeight) {\n        isHandleing = true;\n        load(done);\n      }\n    };\n\n    handler(); // 初始化需要执行下 handler，以拉取初始数据\n    this.handle(handler);\n  }\n\n  reload() {\n    this.setState({ finished: false }, () => {\n      this.componentDidMount();\n    });\n  }\n\n  handle(handler) {\n    if (this._handler !== handler) {\n      this.unhandle();\n      this._handler = handler;\n      // 虽然监听了 scroll，但不需要 throttle，因为内部用了 isHandleing 来过滤\n      window.addEventListener('scroll', handler);\n      window.addEventListener('resize', handler);\n    }\n  }\n\n  unhandle() {\n    if (this._handler) {\n      this._handler = null;\n      window.removeEventListener('resize', this._handler);\n      window.removeEventListener('scroll', this._handler);\n    }\n  }\n\n  componentWillUnmount() {\n    this.unhandle();\n    super.componentWillUnmount();\n    this._isMounded = false;\n  }\n\n  render() {\n    let {hide, message} = this.props;\n    let {finished} = this.state;\n\n    if (hide) return <div/>;\n\n    return (\n      <div ref='el' className={this.classSet('no-select', style.loading, finished && style.finished)}>\n        {finished ? (message || '没有更多了') : <i className={'icon-spin5 spin ' + style.spin}></i>}\n      </div>\n    );\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/tslint-loader!./client/components/message/Loading/Loading.tsx\n **/","import { React, Component } from '../parts';\nimport { MessageFactory } from './MessageFactory';\n\nexport abstract class MessageBuilder extends Component<any, any> {\n  render() {\n    let {props: {message}} = this;\n    let component = MessageFactory.getComponent(message.type);\n    if (!component) {\n      console.error('Not found component for %o', message);\n      return null;\n    }\n\n    return React.createElement(component, this.props);\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/tslint-loader!./client/components/message/Message/MessageBuilder.tsx\n **/","import { React, Component, humanTime } from '../../parts';\nimport { Type, CourseMessage } from '../../types';\nimport { MessageRender } from '../MessageRender';\n\nlet style = require('./styles/subscribe.scss?local');\n\nexport class CourseMessageRender extends MessageRender<CourseMessage, any> {\n  static type: number = Type.Course;\n\n  render() {\n    let {message: m} = this.props;\n    return <div className={this.classSet(style.item, 'flex')}>\n      <div className={style.cover}>\n        <img className={style.cover} src={m.cover} />\n      </div>\n      <div className={style.body} data-flex='1'>\n        <a href={m.link} className={style.link}>\n          <h3 data-clamp='2' className={style.title}>{m.title}</h3>\n          <div className='clearfix'>\n            <span className={'pull-left ' + style.time}>{humanTime(m.createTime)}</span>\n          </div>\n          <p data-clamp='2' className={style.content}>{m.content}</p>\n        </a>\n\n        {this.renderExternal()}\n      </div>\n    </div>;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/tslint-loader!./client/components/message/Message/renders/CourseMessageRender.tsx\n **/","import { React, Component, humanTime } from '../../parts';\nimport { Type, FansMessage } from '../../types';\nimport { MessageRender } from '../MessageRender';\n\nlet style = require('./styles/community.scss?local');\n\nexport class FansMessageRender extends MessageRender<FansMessage, any> {\n  static type: number = Type.Fans;\n\n  render() {\n    let {message: m} = this.props;\n    let fans = m.fans, len = fans.length, firstFan = fans[0].name;\n\n    let content = `“${firstFan}”` + (len === 1 ? '' : `等${len}人`) + '成为了你的粉丝';\n\n    return <div className={style.item}>\n      <div className={style.follows + ' text-ellipsis'}>\n        {fans.map((fan, index) => <img className={style.follow} key={index} src={fan.avatar} />)}\n      </div>\n      <p className={style.content}>{content}</p>\n      <span className={style.time}>{humanTime(m.createTime)}</span>\n\n      {this.renderExternal()}\n    </div>;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/tslint-loader!./client/components/message/Message/renders/FansMessageRender.tsx\n **/","import { React, Component, humanTime } from '../../parts';\nimport { Type, MagazineMessage } from '../../types';\nimport { MessageRender } from '../MessageRender';\n\nlet style = require('./styles/subscribe.scss?local');\n\nexport class MagazineMessageRender extends MessageRender<MagazineMessage, any> {\n  static type: number = Type.Magazine;\n\n  render() {\n    let {message: m} = this.props;\n    return <div className={this.classSet(style.item, 'flex')}>\n      <div className={style.cover}>\n        <img className={style.cover} src={m.cover} />\n      </div>\n      <div className={style.body} data-flex='1'>\n        <a href={m.link} className={style.link}>\n          <h3 data-clamp='2' className={style.title}>{m.title}</h3>\n          <div className='clearfix'>\n            <span className={'pull-left ' + style.time}>{humanTime(m.createTime)}</span>\n            <span className={'pull-right ' + style.time}>更新{m.series}期</span>\n          </div>\n        </a>\n\n        {this.renderExternal()}\n      </div>\n    </div>;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/tslint-loader!./client/components/message/Message/renders/MagazineMessageRender.tsx\n **/","import { React, Component, humanTime } from '../../parts';\nimport { Type, ReplyMessage } from '../../types';\nimport { MessageRender } from '../MessageRender';\n\nlet style = require('./styles/community.scss?local');\n\nexport class ReplyMessageRender extends MessageRender<ReplyMessage, any> {\n  static type: number = Type.Reply;\n\n  render() {\n    let {message: m} = this.props;\n    return <div className={style.item}>\n      {this.renderCommunityUser(m.from, humanTime(m.createTime), style)}\n      <p data-clamp='2' className={style.content}>{m.answer}</p>\n      <div className={style.grayBackground}>\n        <p data-clamp='2' className={style.title}>{m.title}</p>\n      </div>\n\n      {this.renderExternal()}\n    </div>;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/tslint-loader!./client/components/message/Message/renders/ReplyMessageRender.tsx\n **/","import { React, Component, humanTime } from '../../parts';\nimport { Type, SystemMessage } from '../../types';\nimport { MessageRender } from '../MessageRender';\n\nlet style = require('./styles/notice.scss?local');\n\ninterface State {\n  clamp: string;\n}\n\nexport class SystemMessageRender extends MessageRender<SystemMessage, State> {\n  static type: number = Type.System;\n\n  constructor(props) {\n    super(props);\n    this.state.clamp = '2';\n  }\n\n  handleClick() {\n    let {clamp} = this.state;\n    this.setState({clamp: clamp ? '' : '2'});\n  }\n\n  render() {\n    let {message: m} = this.props;\n    let {clamp} = this.state;\n\n    return <div className={style.item}>\n      <p onClick={this.handleClick.bind(this)} className={style.title} data-clamp={clamp}>{m.title}</p>\n      <span className={style.time}>{humanTime(m.createTime)}</span>\n\n      {this.renderExternal()}\n    </div>;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/tslint-loader!./client/components/message/Message/renders/SystemMessageRender.tsx\n **/","import { React, setServerTime, store, api } from '../parts';\nimport { RouteComponentProps } from 'react-router';\nimport { MessageBuilder } from '../Message/';\nimport { MessageGroup, MessageGroupProps, MessageGroupState } from './MessageGroup';\n\nimport { Header, Nav, Loading } from '../parts';\nimport { BusinessUnreadCount, CategoryUnreadCount } from '../types';\n\nlet style = require('./styles.scss?local');\n\ninterface Props extends MessageGroupProps {}\ninterface State extends MessageGroupState {\n  unread?: BusinessUnreadCount;\n  dots?: CategoryUnreadCount;\n  total: number; // 后台消息总数量\n}\n\nexport class MixedMessageGroup extends MessageGroup<Props, State> {\n\n  static contextTypes = {\n    title: React.PropTypes.string\n  };\n\n  context: {\n    title: string;\n  };\n\n  refs: {\n    [key: string]: any;\n    'loading': any;\n  };\n\n  /**\n   * isomorphic 函数只能写在 react-router 的 handle component 中\n   *\n   * 非 handle component（如 Header, Nav）无法执行到，所以如果是这些\n   * 的组件需要用 ajax，那么，最好是将 ajax 提取到 handle component，\n   * 然后通过 props 的方式将数据传给子组件。\n   *\n   * 这些 ajax 请求最好也不能依赖除了 url 相关的数据以外的其它所有资源。\n   *\n   * 此函数除第一个参数之外的其它参数都是为了方便客户端复用而添加的，也就是说\n   * 服务端在调用的时候只会提供第一个参数，且这个参数是 react-router 生成的。\n   */\n  static isomorphic(props, _clientState?: any) {\n    let state = _clientState || MessageGroup.createInitState();\n\n    let {page, pageSize, messages, hideLoading} = state;\n    let {params: {business, category}} = props;\n\n    page++;\n\n    // return Promise.resolve(props);\n    return api.getCagegoryMessages({business, category, page, pageSize})\n      .then(data => {\n        let {collection, page, total, unread} = data;\n\n        // 只需要第一次设置成功即可，之后 data 是从缓存中来的，不准确\n        setServerTime(data.now);\n        messages.push(...collection);\n        let size = messages.length;\n\n        // 如果总数量不超过一屏，则不需要显示加载条\n        hideLoading = size && size < pageSize;\n\n        // 因为 HTTP 缓存，所以得到的 dots[k] 要处理下\n        let dots = store.get('dots', {});\n        Object.keys(unread.category).forEach(k => {\n          if (k === category) dots[k] = 0; // 当前 tab 不需要出现红点\n          else if (dots[k] !== 0) dots[k] = unread.category[k];\n        });\n        store.set('dots', dots);\n\n        let state = {page, messages, hideLoading, total, unread: unread.business};\n\n        // 如果是在服务端渲染，修改组件的初始状态\n        if (!_clientState) {\n          MixedMessageGroup.initState = state;\n        }\n\n        return Promise.resolve(state);\n      });\n  }\n\n  load(done) {\n    let {props, state} = this;\n    this.getConstructor().isomorphic(props, state)\n      .then(state => {\n        if (this._isMounted) {\n          this.setState(state);\n          done(state.messages.length >= state.total);\n        }\n      });\n  }\n\n  getMessageList() {\n    let {messages, unread} = this.state;\n    let {business, category} = this.props.params;\n    return messages.map((message) => {\n      return <MessageBuilder key={message.id}\n        business={business}\n        category={category}\n        message={message}\n        unread={unread} />;\n    });\n  }\n\n  componentWillReceiveProps(props) {\n    let state = MessageGroup.createInitState();\n    this.setState(state, () => {\n      this.refs.loading.reload();\n    });\n  }\n\n  render() {\n    let dots = store.get('dots');\n    let {load, state: {hideLoading, unread}, props: {params: {business}}} = this;\n\n    return (\n      <div>\n        <Header title={this.context.title}/>\n        <Nav business={business} dots={dots} />\n        <div className={this.classSet(style.list, style.mixedList)}>\n          {this.getMessageList()}\n        </div>\n        <Loading ref='loading' hide={hideLoading} load={load.bind(this)}/>\n      </div>\n    );\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/tslint-loader!./client/components/message/MessageGroup/MixedMessageGroup.tsx\n **/","import {  Header, Loading, React, setServerTime, api } from '../parts';\nimport { CategoryMap, BusinessMap } from '../types';\nimport { RouteComponentProps } from 'react-router';\nimport { MessageBuilder } from '../Message/';\nimport { MessageGroup, MessageGroupProps, MessageGroupState } from './MessageGroup';\n\n\ninterface Props extends MessageGroupProps {}\ninterface State extends MessageGroupState {\n  showAppBanner?: boolean;\n}\n\nlet style = require('./styles.scss?local');\n\nexport class SimpleMessageGroup extends MessageGroup<Props, State> {\n\n  static isomorphic(props, _clientState) {\n    let state = _clientState || MessageGroup.createInitState();\n\n    let {page, pageSize, messages, hideLoading} = state;\n    let {params: {subBusiness: business, category}} = props;\n\n    page++;\n    return api.getBusinessUnreadMessages({category, business})\n      .then(data => {\n        let {collection: messages} = data;\n        let hideLoading = !!messages.length; // 当显示数量为 0 时，还是要显示进度条（这时进度条显示的是“没有更多数据了”之类的）\n        let showAppBanner = hideLoading && data.total > messages.length;\n\n        setServerTime(data.now);\n\n        let state = {messages, hideLoading, showAppBanner, page, pageSize};\n\n        if (!_clientState) {\n          SimpleMessageGroup.initState = state;\n        }\n\n        return Promise.resolve(state);\n      });\n  }\n\n  getMessageList() {\n    return this.state.messages.map(message => {\n      return <MessageBuilder key={message.id} message={message} />;\n    });\n  }\n\n  load(done) {\n    let {props, state} = this;\n\n    /*\n      只执行一次，因为会有这么一个 BUG:\n      拉取第一屏，并将这一屏的消息设置成已读，再回退到上一页面，再进来，消息数量就不是外面显示的数量了；\n      如果不将消息设置成已读，那么消息无法读完。\n\n      解决方案：\n      永远只拉取一屏消息，不要将这些消息设置成已读，回去后，再进来看到的都是一样（因为有 http 缓存），\n      除非刷新页面\n     */\n    if (state.page > 0) return done(true);\n\n    this.getConstructor().isomorphic(props, state, done)\n      .then(state => {\n        if (this._isMounted) {\n          this.setState(state);\n          done(true);\n        }\n      });\n  }\n\n  render() {\n    let {load, state: {hideLoading, showAppBanner}} = this;\n    let {category, subBusiness: business} = this.props.params;\n    let app = BusinessMap[business];\n    let title = CategoryMap[category] + ' - ' + app;\n    return (\n      <div>\n        <Header title={title}/>\n        <div className={this.classSet(style.list, style.simpleList)}>\n          {this.getMessageList()}\n        </div>\n        <Loading hide={hideLoading} load={load.bind(this)}/>\n        {showAppBanner && <a className={style.download} href='http://m.hujiang.com/app/'>\n          查看更多消息，请下载{app}客户端 &gt; </a>}\n      </div>\n    );\n  }\n}\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/tslint-loader!./client/components/message/MessageGroup/SimpleMessageGroup.tsx\n **/","export * from './MixedMessageGroup';\nexport * from './SimpleMessageGroup';\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/tslint-loader!./client/components/message/MessageGroup/index.tsx\n **/","import { React, Component } from '../parts';\nimport { CategoryKeys, CategoryMap } from '../types';\nimport { Link, RouteComponentProps } from 'react-router';\n\ninterface Props extends React.Props<any> {\n  business: string;\n  dots?: any;\n}\ninterface State  {}\n\nlet style = require('./nav.scss?local');\n\nexport class Nav extends Component<Props, State> {\n\n  render() {\n    let {business, dots = {}} = this.props;\n    let children = CategoryKeys.map(key => {\n      let label = CategoryMap[key];\n      let path = `/${business}/${key}`;\n\n      return (<li data-flex='1' key={key} className={dots[key] ? style.dot : null}>\n        <Link to={path} className={style.link} activeClassName={style.active}>{label}</Link>\n      </li>);\n    });\n\n    return <ul className={'flex ' + style.nav}>{children}</ul>;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/tslint-loader!./client/components/message/Nav/Nav.tsx\n **/","let elegantApi: ElegantApi = require('elegant-api');\nimport {mocks} from '../../mock/';\nimport {\n  CagegoryMessagesResponse,\n  BusinessUnreadMessagesResponse,\n  MessageResponse\n} from '../../mock/types';\n\n\nexport interface CagegoryMessagesParams {\n  category: string;\n  business: string;\n  page?: number;\n  pageSize?: number;\n}\n\n/*\n  __ISOMORPHIC__: 同构模式\n  __ISO_CLIENT__: 同构模式下的客户端\n  __ISO_SERVER__: 同构模式下的服务端（因为此脚本也会被服务端调用）\n*/\n\n// console.log(__ISO_CLIENT__, __ISO_SERVER__, __ISOMORPHIC__);\n\nexport interface BusinessUnreadMessagesParams {\n  category: string;\n  business: string;\n  page?: number;\n  pageSize?: number;\n}\n\nexport interface MessageParams {\n  id: number;\n}\n\nexport interface API extends ElegantApiColluction {\n  getCagegoryMessages: EAApi<CagegoryMessagesParams, CagegoryMessagesResponse>;\n  getBusinessUnreadMessages: EAApi<BusinessUnreadMessagesParams, BusinessUnreadMessagesResponse>;\n  getMessage: EAApi<MessageParams, MessageResponse>;\n}\n\n\nexport let api: API = elegantApi({\n  base: '/api/messages',\n  // 去除 request 和 response 所有格式化的规则\n  response: { order: [] },\n  request: { order: [] },\n  cache: {\n    enable: 'smart',\n    expireSeconds: __ISO_SERVER__ ? 10 : 0 // 服务端只需要 10s 的短暂的缓存，客户端无限缓存\n  },\n  dataTransformMethod: 'cookie',\n  mock: {\n    memory: __STANDALONE__ || __ISO_SERVER__,\n    server: __ISO_CLIENT__ ? 'self' : null\n  },\n  handle(target: EAOptionHandleTarget, cb: EACallback) {\n    let routeName = this.name;\n\n    if (__ISO_CLIENT__ || __STANDALONE__) {\n      console.log(`%c${routeName}%c ${target.http.url} %o`, 'color:green; background:yellow;', 'color:red', target);\n    }\n\n    let done = (rtnData, error, cb) => {\n      let d: any = rtnData || {};\n      let {data, message, status} = d;\n      let errorMessage, oldError;\n\n      if (error) {\n        errorMessage = '网络异常，请稍后再试';\n        oldError = error;\n        status = -1;\n        console.log(oldError);\n      } else if (status !== 0) {\n        errorMessage = message || '未知错误，状态码 ' + status;\n      }\n\n      if (errorMessage) {\n        error = new Error(errorMessage);\n        error.status = status;\n        error.message = errorMessage;\n        error.oldError = oldError;\n      }\n\n      return cb(error, data);\n    };\n\n    let {data, http, error} = target;\n    let {method, url} = http;\n\n    delete http.crossOrigin;\n    delete http.dataType;\n\n    if (method === 'HEAD' || method === 'GET') {\n      delete http['body']; // 不删除会导致火狐下报错\n    } else if (method === 'POST' || method === 'DELETE') {\n      http['body'] = JSON.stringify(http['body']);\n    }\n\n    if (this.mock.memory) return done(data, error, cb);\n    fetch(http.url, http)\n      .then(res => {\n        let {status} = res;\n        if (status >= 200 && status < 300) {\n          return res.json();\n        } else {\n          let err = new Error('STATUS NOT OK');\n          err['response'] = res;\n          throw err;\n        }\n      })\n      .then(data => done(data, null, cb))\n      .catch(err => done(null, err, cb));\n\n  },\n  routes: {\n    // 获取某一个大类的所有消息\n    // 非指定的业务线只显示第一条\n    getCagegoryMessages: {\n      path: '/:category/:business',\n      query: 'page=1&pageSize=10'\n    },\n\n    // 从大类中进入的某一个具体的小类的所有消息\n    // 只显示指定的业务线，并且只显示未读消息\n    getBusinessUnreadMessages: {\n      path: '/group/:category/:business',\n      query: 'page=1&pageSize=10'\n    },\n\n    // 获取具体的某一条消息\n    getMessage: {\n      path: '/:id'\n    }\n  },\n  mocks\n});\n\n// 在客户端\nif (typeof window !== 'undefined') {\n  (() => {\n    let win: any = window;\n    win.api = api;\n\n    if (G && G.eaCache) {\n      api.$cache(G.eaCache);\n    }\n  })();\n}\n\nexport {Category, Business, Type} from '../../mock/types';\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/tslint-loader!./client/libs/api.tsx\n **/","let diffMillseconds: number;\n\n/**\n * 设置服务端时间，得到客户端时间和服务端时间之间\n */\nexport function setServerTime(time: number): void {\n  if (diffMillseconds == null) {\n    diffMillseconds = time - Date.now();\n  }\n}\n\n/**\n * 获取当前服务器时间\n */\nexport function getServerTime(): number {\n  if (diffMillseconds == null) {\n    console.warn('Not set server time yet, using client time temporarily!');\n  }\n  return (diffMillseconds || 0) + Date.now();\n}\n\nexport function humanTime(lastTime: number): string {\n  let lastDate, currentDate, diff;\n  let currentTime = getServerTime();\n  diff = Math.floor((currentTime - lastTime) / 60000); // 化成分钟\n\n  if (diff < 1) return '刚刚';\n  if (diff < 60) return diff + '分钟前'; // 60 分钟内\n  if (diff < 1440) return Math.floor(diff / 60) + '小时前';  // 1 小时 - 24 小时\n  if (diff < 14400) return Math.floor(diff / 1440) + '天前'; // 1 天 - 10 天\n\n  lastDate = new Date(lastTime);\n  currentDate = new Date(currentTime);\n\n  let year = lastDate.getFullYear(),\n    month = lastDate.getMonth() + 1,\n    day = lastDate.getDate(),\n    result = [month, day];\n\n  if (year !== currentDate.getFullYear()) result.unshift(year);\n\n  return result.join('-');\n}\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/tslint-loader!./client/libs/helper.tsx\n **/","let _storeData: any = {};\n\nexport const store = {\n\n  get<T>(key: string, defaultVal?: T): T {\n    return (key in _storeData) ? _storeData[key] : defaultVal;\n  },\n\n  set<T>(key: string, val: T) {\n    _storeData[key] = val;\n  },\n\n  append(key: string, items: any[]) {\n    let collection = this.get(key, []);\n    collection.push(...items);\n    this.set(key, collection);\n  }\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/tslint-loader!./client/libs/store.tsx\n **/","// https://github.com/reactjs/react-router/blob/master/docs/guides/RouteConfiguration.md\n\nimport { App } from '../components/message/parts';\nimport { MixedMessageGroup, SimpleMessageGroup } from '../components/message/MessageGroup';\nimport {\n  defaultBusinessKey as dbk, defaultCategoryKey as dck,\n  BusinessMap, CategoryMap\n} from '../components/message/types';\n\nexport const routes = {\n  path: '/',\n  component: App,\n  // indexRoute: { path: `/${dbk}/${dck}`, component: MixedMessageGroup },\n  // indexRoute: { onEnter(next, replace) { replace(`/${dbk}/${dck}`); } },\n  indexRoute: createRedirectIndexRoute(params => `/${dbk}/${dck}`),\n\n  childRoutes: [\n    {\n      path: '/:business',\n      component: '',\n      indexRoute: createRedirectIndexRoute((params) => {\n        return `/${getBusiness(params.business)}/${dck}`;\n      })\n    },\n    {\n      path: '/:business/:category',\n      component: MixedMessageGroup,\n      indexRoute: createRedirectIndexRoute((params) => {\n        let {business, category} = params;\n        return `/${getBusiness(business)}/${getCategory(category)}`;\n      })\n    },\n    {\n      path: '/:business/:category/:subBusiness',\n      component: SimpleMessageGroup,\n      indexRoute: createRedirectIndexRoute((params) => {\n        let {business, category, subBusiness} = params;\n        return `/${getBusiness(business)}/${getCategory(category)}/${getBusiness(subBusiness)}`;\n      })\n    }\n  ]\n};\n\nfunction getBusiness(b) {\n  return b in BusinessMap ? b : dbk;\n}\nfunction getCategory(c) {\n  return c in CategoryMap ? c : dck;\n}\n\n\nfunction createRedirectIndexRoute(cb) {\n  return {\n    onEnter(next, replace) {\n      let {params, location: {pathname, search}} = next;\n      let url = cb(params);\n      if (url && url !== pathname) return replace(url + search);\n      return false;\n    }\n  };\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/tslint-loader!./client/share/routes.tsx\n **/","/**\n * 数据生成器\n *\n * 本来可以引入第三方的数据生成器，但为了使文件 size 小点，还是自己写个精短版的\n */\n\nimport {\n  Link, User, Message,\n  Category, Business, Type,\n  CourseMessage, FansMessage, MagazineMessage, ReplyMessage, SystemMessage,\n  enumKeys, enumValues\n} from './types';\n\nlet enumFamilyName = `王李张刘陈杨赵黄周吴徐孙胡朱高林何郭马罗梁宋郑谢\n韩唐冯于董萧程曹袁邓许傅沈曾彭吕苏卢蒋蔡贾丁魏薛叶阎余潘杜戴夏锺汪田任姜范\n方石姚谭廖邹熊金陆郝孔白崔康毛邱秦江史顾侯邵孟龙万段雷钱汤尹黎易常武乔贺赖\n龚文`.replace(/\\s/g, '').split('');\nlet enumGiveName = `伟芳娜秀英敏静丽强磊军洋勇艳杰娟涛明超秀兰霞平刚桂英`.split('');\nlet enumText = `人类长期只有口语用文字记录口语形成的书面语历史很短系统的语言成为人和禽兽分离的重要工具文字`.split('');\n\nlet enumAvatar = `\nd8bad2c0f825c92e0415a5d46c3d2fbe1\nd8b2ba8cf572fba9f88e6f565e772714c\nddc6410213bd2a6d782e3feaf31d389f3\ndad84c291ff1f262000f96d36a8dd7ffc\nd4f8fce2c1195a53d3e688d8f6a6614ce\nd868f7175ff7f7e6c2e116988f6851f3b\ndfb05cc71c257a8038932208222e9f8d2\nd11258715ca4af94e73f28b6a6d51aac1\ndcbb8effef6f889c2aaf3a5712dfe401b\n`.trim().split(/\\s/).map(k => `http://cdn.llsapp.com/${k}.jpg`);\n\n// min <= x <= max\nfunction rand(min: number = 0, max: number = 60): number {\n  return min + Math.floor(Math.random() * (max + 1 - min));\n}\n\nfunction sample(arg: any): any {\n  let list = arg;\n  if (!Array.isArray(arg)) list = Object.keys(arg).map(k => arg[k]);\n  return list[rand(0, list.length - 1)];\n}\n\nfunction sampleEnumValue(arg: any): any {\n  return sample(enumValues(arg));\n}\n\nfunction sampleEnumKey(arg: any): any {\n  return sample(enumKeys(arg));\n}\n\nfunction text(min: number = 1, max: number = 120): string {\n  let len = rand(min, max);\n  return fill(len, () => sample(enumText)).join('');\n}\n\nfunction link(id): Link {\n  return 'http://www.baidu.com?id=' + id;\n}\n\nvar category = () => sampleEnumValue(Category);\nvar business = () => sampleEnumValue(Business);\nvar type = () => sampleEnumValue(Type);\nvar bool = () => rand(1, 100) > 50;\nvar image = () => sample(enumAvatar);\n\n\nvar now = Date.now();\nvar oneDay = 86400000;\nvar lastCreateTime = now - oneDay * 365;\nvar getCreateTime = () => {\n  lastCreateTime = lastCreateTime + Math.round((now - lastCreateTime) * Math.random());\n  return lastCreateTime;\n};\nvar lastId = 1;\n\nexport let Generator = {\n  sampleEnumKey,\n  sampleEnumValue,\n  now, oneDay,\n  rand, sample, fill,\n  category, business, type,\n  Category, Business, Type,\n  User(): User {\n    let giveName = sample(enumGiveName);\n    if (bool()) giveName += sample(enumGiveName);\n    return {\n      name: sample(enumFamilyName) + giveName,\n      avatar: image()\n    };\n  },\n  Message(): Message {\n    let createTime = getCreateTime();\n    let id = lastId++;\n    let isRead = bool();\n\n    return {\n      category: category(),\n      business: business(),\n      type: type(),\n      createTime,\n      id,\n      isRead,\n      readTime: isRead ? Math.min(now, createTime + Math.round(Math.random() * oneDay * 10)) : 0\n    };\n  },\n  SystemMessage(): SystemMessage {\n    return message(m => {\n      m.category = Category.notice;\n      m.title = text();\n      m.type = Type.System;\n    });\n  },\n  ReplyMessage(): ReplyMessage {\n    return message(m => {\n      m.category = Category.community;\n      m.title = text();\n      m.answer = text();\n      m.link = link(m.id);\n      m.from = user();\n      m.type = Type.Reply;\n    });\n  },\n  FansMessage(): FansMessage {\n    return message(m => {\n      m.category = Category.community;\n      m.fans = fill(rand(1, 10), user);\n      m.type = Type.Fans;\n    });\n  },\n  CourseMessage(): CourseMessage {\n    return message(m => {\n      m.category = Category.subscribe;\n      m.title = text();\n      m.content = text();\n      m.link = link(m.id);\n      m.type = Type.Course;\n      m.cover = image();\n    });\n  },\n  MagazineMessage(): MagazineMessage {\n    return message(m => {\n      m.category = Category.subscribe;\n      m.title = text();\n      m.link = link(m.id);\n      m.series = rand(100, 9999);\n      m.type = Type.Magazine;\n      m.cover = image();\n    });\n  }\n};\n\nfunction user(): User {\n  return Generator.User();\n}\n\nfunction message(cb: Function): any {\n  let m = Generator.Message();\n  cb(m);\n  return m;\n}\n\nfunction fill(num: number, generate: Function, context?: any): Array<any> {\n  let result = [];\n  for (let i = 0; i < num; i++) result.push(generate.call(context));\n  return result;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/tslint-loader!./mock/generator.ts\n **/","import {Message, ResponseData, enumKeys} from './types';\nimport {Generator} from './generator';\nlet {sample, fill, sampleEnumKey, Type, Business, Category, now, oneDay} = Generator;\n\nconst TOTAL_MESSAGE = 1000; // 总消息数量\nconst TOTAL_READ_MESSAGE = 500; // 已读消息的数量\nlet MESSAGES = Generator\n  .fill(TOTAL_MESSAGE, () => {\n    return Generator[sampleEnumKey(Type) + 'Message']();\n  })\n  .map((message: Message, index) => {\n    if (index < TOTAL_READ_MESSAGE) {\n      message.isRead = true;\n      message.readTime = Math.min(now, message.createTime + Math.round(Math.random() * oneDay * 10));\n    } else {\n      message.isRead = false;\n      message.readTime = 0;\n    }\n    return message;\n  })\n  .reverse();\n\nlet BUSINESS_MESSAGES: any = {};\nlet CATEGORY_MESSAGES: any = {};\n\nMESSAGES.forEach((message: Message) => {\n  save(message, Business, 'business', BUSINESS_MESSAGES);\n  save(message, Category, 'category', CATEGORY_MESSAGES);\n});\n\nfunction save(message: Message, map: any, id: string, collection: any) {\n  let label = map[message[id]];\n  if (!collection[label]) collection[label] = [];\n  collection[label].push(message);\n}\n\nfunction getUnreadCountBy(id, map, collection) {\n  let result: any = {};\n  enumKeys(map).forEach(k => result[k] = 0);\n  collection.forEach((message: Message) => {\n    if (!message.isRead) {\n      result[map[message[id]]]++;\n    }\n  });\n  return result;\n}\n\nfunction getUnreadCountByCategory(businessCollection) {\n  return getUnreadCountBy('category', Category, businessCollection);\n}\n\nfunction getUnreadCountByBusiness(categoryCollection) {\n  return getUnreadCountBy('business', Business, categoryCollection);\n}\n\n/**\n * 统一化返回的数据\n */\nfunction response(data: any = null, status: number = 0, message: string = ''): ResponseData {\n  return {data, status, message};\n}\n\nfunction filter(category: string, business: string, query: any) {\n\n  let categoryCollection = CATEGORY_MESSAGES[category];\n  let businessCollection = BUSINESS_MESSAGES[business];\n\n  // 取出当前业务线上的消息，其它业务线只显示第一条\n  let map = {};\n  let collection = categoryCollection.filter(message => {\n    let mb = message.business;\n    if (mb in map) return false;\n\n    if (Business[mb] !== business) {\n      map[mb] = true;\n    }\n    return true;\n  });\n\n  let result = page(collection, query);\n\n  // NOTE: 这样每次刷新就都会出现红点，如果正式使用，需要去掉下面这行的注释\n  // read(categoryCollection, business);\n  result.unread = {\n    business: getUnreadCountByBusiness(categoryCollection),\n    category: getUnreadCountByCategory(businessCollection)\n  };\n  return result;\n}\n\nfunction page(collection, query): any {\n  let total = collection.length;\n  let {page, pageSize} = query;\n  let now = Date.now();\n  page = parseInt(page, 10) || 1;\n  pageSize = parseInt(pageSize, 10) || 10;\n\n  collection = collection.slice((page - 1) * pageSize, page * pageSize);\n\n  return {\n    collection, total, page, pageSize, now\n  };\n}\n\nfunction read(collection, business) {\n  collection.forEach(message => {\n    if (Business[business] === message.business) {\n      message.isRead = true;\n      message.readTime = Date.now();\n    }\n  });\n}\n\nfunction checkCategory(category, callback) {\n  if (!category || !(category in Category)) {\n    callback(null, response(null, 500, 'category not exist or illegal'));\n    return false;\n  }\n  return true;\n}\nfunction checkBusinese(business, callback) {\n  if (!business || !(business in Business)) {\n    callback(null, response(null, 500, 'business not exist or illegal'));\n    return false;\n  }\n  return true;\n}\nfunction check(category, business, cb) {\n  return checkCategory(category, cb) && checkBusinese(business, cb);\n}\n\n\nexport var mocks: EAOptionMocks = {\n\n  /**\n   * 获取指定的 category 的所有消息\n   */\n  getCagegoryMessages(target: EAMockHandleTarget, callback: EACallback) {\n    let {query, params} = target;\n    let {category, business} = params;\n\n    if (check(category, business, callback)) {\n      callback(null, response(filter(category, business, query)));\n    }\n  },\n\n  /**\n   * 获取指定的 business 的所有消息\n   */\n  getBusinessUnreadMessages(target: EAMockHandleTarget, callback: EACallback) {\n    let {query, params} = target;\n    let {business, category} = params;\n\n    if (check(category, business, callback)) {\n      let collection = CATEGORY_MESSAGES[category]\n        .filter((message: Message) => {\n          return !message.isRead\n            && Business[message.business] === business;\n        });\n      callback(null, response(page(collection, query)));\n    }\n  },\n\n  /**\n   * 获取某一条消息\n   */\n  getMessage(target: EAMockHandleTarget, callback: EACallback) {\n    let id: number = parseInt(target.params.id), found;\n\n    if (id) {\n      MESSAGES.forEach((message: Message) => {\n        if (message.id === id) {\n          found = true;\n          return callback(null, response(message));\n        }\n      });\n    }\n\n    if (!found) {\n      callback(null, response(null, 500, 'message not found or id not exist'));\n    }\n  },\n\n  $default(target: EAMockHandleTarget, callback: EACallback) {\n    callback(null, response());\n  }\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/tslint-loader!./mock/index.ts\n **/","// removed by extract-text-webpack-plugin\nmodule.exports = {\"header\":\"_3XuQ2892\",\"back\":\"_1_IIGf8k\",\"title\":\"_2jC9o7gf\"};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./client/components/message/Header/header.scss?local\n ** module id = 72\n ** module chunks = 2\n **/","// removed by extract-text-webpack-plugin\nmodule.exports = {\"loading\":\"_2cm2hXUP\",\"finished\":\"AKumWgsl\",\"spin\":\"_3zXuHUyu\"};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./client/components/message/Loading/loading.scss?local\n ** module id = 73\n ** module chunks = 2\n **/","// removed by extract-text-webpack-plugin\nmodule.exports = {\"from\":\"_1YLmEQ_b\",\"external\":\"_3ZSeCsqu\"};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./client/components/message/Message/renders/styles/common.scss?local\n ** module id = 74\n ** module chunks = 2\n **/","// removed by extract-text-webpack-plugin\nmodule.exports = {\"item\":\"_1ZtHA02R\",\"title\":\"_1a13q_7p\",\"time\":\"_2z582xM4\"};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./client/components/message/Message/renders/styles/notice.scss?local\n ** module id = 75\n ** module chunks = 2\n **/","// removed by extract-text-webpack-plugin\nmodule.exports = {\"nav\":\"_1HJQLwR4\",\"link\":\"FuD-CNOa\",\"dot\":\"_8SVpk3Qg\",\"active\":\"_3zoFbV__\"};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./client/components/message/Nav/nav.scss?local\n ** module id = 76\n ** module chunks = 2\n **/"],"sourceRoot":""}